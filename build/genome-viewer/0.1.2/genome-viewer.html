<!DOCTYPE HTML>
<html>
    
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Genome Viewer Demo</title>
        <!-- CSS from vendors -->
        <link type="text/css" rel="stylesheet" href="vendor/bootstrap/css/bootstrap-responsive.min.css" />
        <link type="text/css" rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css" />
        <link type="text/css" rel="stylesheet" href="vendor/qtip2/jquery.qtip.min.css" />
        <link type="text/css" rel="stylesheet" href="vendor/ChemDoodleWeb-5.1.0/ChemDoodleWeb.css" />
        <link type="text/css" rel="stylesheet" href="vendor/jquery-ui-slider/jquery-ui-1.10.3.slider.min.css" />
        <!-- CSS from Genome Viewer -->
        <link type="text/css" rel="stylesheet" href="styles/css/style.css" />
        <!-- JS from vendors -->
        <script type="text/javascript" src="vendor/underscore/underscore-min.js"></script>
        <script type="text/javascript" src="vendor/backbone/backbone-min.js"></script>
        <script type="text/javascript" src="vendor/rawdeflate/rawdeflate.js"></script>
        <script type="text/javascript" src="vendor/jquery/jquery-1.10.1.min.js"></script>
        <script type="text/javascript" src="vendor/bootstrap/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="vendor/qtip2/jquery.qtip.min.js"></script>
        <script type="text/javascript" src="vendor/jquery-plugins/jquery.cookie.js"></script>
        <script type="text/javascript" src="vendor/jquery-plugins/jquery.sha1.js"></script>
        <script type="text/javascript" src="vendor/jquery-plugins/jquery.smartresize.js"></script>
        <script type="text/javascript" src="vendor/jquery-plugins/jquery.url.js"></script>
        <script type="text/javascript" src="vendor/ChemDoodleWeb-5.1.0/ChemDoodleWeb-libs.js"></script>
        <script type="text/javascript" src="vendor/ChemDoodleWeb-5.1.0/ChemDoodleWeb.js"></script>
        <script type="text/javascript" src="vendor/jquery-ui-slider/jquery-ui-1.10.3.slider.min.js"></script>
        <!-- JS from Genome Viewer -->
        <script type="text/javascript" src="genome-viewer.min.js"></script>
        <!-- Google Analytics -->
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-16414504-2']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script');
                ga.type = 'text/javascript';
                ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(ga, s);
            })();
        </script>
        <script type="text/javascript">
            var genomeViewer = null;
            $(document).ready(function() {
                var region = new Region({
                        chromosome: "13",
                        start: 32889611,
                        end: 32973805
                    });
                //        var region = new Region({chromosome: "13", start: 32889611, end: 32889611});
                genomeViewer = new GenomeViewer({
                        region: region,
                        sidePanel: false,
                        targetId: 'application',
                        autoRender: true

                    }); //the div must exist
                genomeViewer.draw();

                this.sequence = new SequenceTrack({
                        targetId: null,
                        id: 1,
                        title: 'Sequence',
                        histogramZoom: 20,
                        transcriptZoom: 50,
                        height: 30,
                        visibleRange: {
                            start: 99,
                            end: 100
                        },
                        featureTypes: FEATURE_TYPES,

                        renderer: new SequenceRenderer(),

                        dataAdapter: new SequenceAdapter({
                                category: "genomic",
                                subCategory: "region",
                                resource: "sequence",
                                species: genomeViewer.species,
                                featureCache: {
                                    gzip: true,
                                    chunkSize: 1000
                                }
                            })
                    });

                genomeViewer.addTrack(this.sequence);

                this.gene = new GeneTrack({
                        targetId: null,
                        id: 2,
                        title: 'Gene',
                        histogramZoom: 20,
                        transcriptZoom: 50,
                        height: 140,
                        visibleRange: {
                            start: 0,
                            end: 100
                        },
                        featureTypes: FEATURE_TYPES,

                        renderer: new GeneRenderer(),

                        dataAdapter: new CellBaseAdapter({
                                category: "genomic",
                                subCategory: "region",
                                resource: "gene",
                                species: genomeViewer.species,
                                featureCache: {
                                    gzip: true,
                                    chunkSize: 50000
                                },
                                filters: {},
                                options: {},
                                featureConfig: FEATURE_CONFIG.gene
                            })
                    });

                genomeViewer.addTrack(this.gene);

                //        this.icgcMutationsTrack = new IcgcTrack({
                //            targetId:null,
                //            id:3,
                //            title:'ICGC Mutations',
                //            histogramZoom:70,
                //            labelZoom:80,
                //            height:100,
                //            visibleRange:{start:0,end:100},
                //            featureTypes:FEATURE_TYPES,
                //
                //            renderer:new FeatureRenderer(),
                //
                //            dataAdapter:new IcgcAdapter({
                //                category: "genomic",
                //                subCategory: "region",
                //                resource: "snp",
                //                params:{
                //                    exclude:'transcriptVariations,xrefs,samples'
                //                },
                //                species: genomeViewer.species,
                //                featureCache:{
                //                    gzip: true,
                //                    chunkSize:10000
                //                },
                //                filters:{},
                //                options:{},
                //                featureConfig:FEATURE_CONFIG.snp
                //            })
                //        });
                //        genomeViewer.addTrack(this.icgcMutationsTrack);


                this.snp = new FeatureTrack({
                        targetId: null,
                        id: 4,
                        title: 'SNP',
                        histogramZoom: 70,
                        labelZoom: 80,
                        height: 100,
                        visibleRange: {
                            start: 0,
                            end: 100
                        },
                        featureTypes: FEATURE_TYPES,
                        renderer: new FeatureRenderer({
                                label: function(f) {
                                    return ('name' in f) ? f.name : f.id;
                                },
                                tooltipTitle: function(f) {
                                    var name = (f.name != null) ? f.name : f.id;
                                    return f.featureType.toUpperCase() + ' - <span class="ok">' + name + '</span>';
                                },
                                tooltipText: function(f) {
                                    return 'alleles:&nbsp;<span class="ssel">' + f.alleleString + '</span><br>' +
                                        FEATURE_TYPES.getTipCommons(f) +
                                        'source:&nbsp;<span class="ssel">' + f.source + '</span><br>';

                                },
                                color: 'lightblue',
                                infoWidgetId: "id",
                                height: 8,
                                histogramColor: "orange",
                                handlers: {
                                    'feature:mouseover': function(e) {
                                        console.log(e)
                                    },
                                    'feature:click': function(event) {
                                        new SnpInfoWidget(null, genomeViewer.species).draw(event);
                                    }
                                }
                            }),

                        dataAdapter: new CellBaseAdapter({
                                category: "genomic",
                                subCategory: "region",
                                resource: "snp",
                                params: {
                                    exclude: 'transcriptVariations,xrefs,samples'
                                },
                                species: genomeViewer.species,
                                featureCache: {
                                    gzip: true,
                                    chunkSize: 10000
                                },
                                filters: {},
                                options: {},
                                featureConfig: FEATURE_CONFIG.snp
                            })
                    });

                genomeViewer.addTrack(this.snp);
            });
        </script>
    </head>
    
    <body style="overflow: hidden;">
        <div style=""></div>
        <div id="application" style="width:98%; position:relative; left:10px; top:10px;"></div>
        <div style=""></div>
    </body>

</html>