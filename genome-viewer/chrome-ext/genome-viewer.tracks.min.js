function Track(a,c,b){this.args=b;this.labelNodeGroup=this.mainNodeGroup=this.trackNodeGroup=null;this.internalId=Math.round(1E7*Math.random());null!=c&&(this.targetID=c.id);this.top=0;this.left=100;this.right=900;this.width=1100;this.height=50;this.originalTop=this.top;this.maxHeight=this.originalHeight=this.height;null!=b?(this.start=b.start,this.end=b.end):this.start=0;this.pixelRatio=5;this.backgroundColor="#FFFFFF";this.titleColor="#000000";this.overflow=!1;this.titleName=this.title=null;this.titleFontSize=
10;this.titleWidth=50;this.titleHeight=12;this.floating=!1;this.repeatLabel=null;this.isAvalaible=!0;this.isNotAvalaibleMessage="This level of zoom isn't appropiate for this track";this.labelFontSize=null;null!=b&&(null!=b.left&&(this.left=b.left),null!=b.top&&(this.originalTop=this.top=b.top),null!=b.left&&(this.left=b.left),null!=b.right&&(this.right=b.right),null!=b.width&&(this.width=b.width),null!=b.floating&&(this.floating=b.floating),null!=b.height&&(this.maxHeight=this.originalHeight=this.height=
b.height),null!=b.backgroundColor&&(this.backgroundColor=b.backgroundColor),null!=b.titleWidth&&(this.titleWidth=b.titleWidth),null!=b.titleFontSize&&(this.titleFontSize=b.titleFontSize),null!=b.titleHeight&&(this.titleHeight=b.titleHeight),null!=b.titleColor&&(this.titleColor=b.titleColor),null!=b.title&&(this.title=!0,this.titleName=b.title),null!=b.overflow&&(this.overflow=b.overflow),null!=b.pixelRatio&&(this.pixelRatio=b.pixelRatio),null!=b.labelFontSize&&(this.labelFontSize=b.labelFontSize),
null!=b.repeatLabel&&(this.repeatLabel=b.repeatLabel),null!=b.isAvalaible&&(this.isAvalaible=b.isAvalaible),null!=b.isNotAvalaibleMessage&&(this.isNotAvalaibleMessage=b.isNotAvalaibleMessage));this.id=a;this.idTrack=this.id+"_Features";this.idNames=this.id+"_Names";this.idMain=this.id+"_Main";this.idBackground=this.id+"_background";this.idTitleGroup=this.id+"_title_group";this.click=new Event(this)}Track.prototype._getViewBoxCoordenates=function(){return"0 10 "+this.width+" "+this.height};
Track.prototype.createSVGDom=function(a){null==this._svg&&(this._svg=SVG.createSVGCanvas(DOM.select(this.targetID),[["viewBox",this._getViewBoxCoordenates()],["preserveAspectRatio","none"],["id",a],["height",this.height],["width",this.width]]));this.mainNodeGroup=SVG.drawGroup(this._svg,[["id",this.idMain]]);this.backgroundNodeGroup=SVG.drawGroup(this.mainNodeGroup,[["id",this.idBackground]]);this.trackNodeGroup=SVG.drawGroup(this.mainNodeGroup,[["id",this.idTrack]]);this.labelNodeGroup=SVG.drawGroup(this.mainNodeGroup,
[["id",this.idNames]]);this.titleNodeGroup=SVG.drawGroup(this.mainNodeGroup,[["id",this.idTitleGroup]]);this.drawBackground();return this._svg};Track.prototype.drawBackground=function(){};Track.prototype.getBackgroundNode=function(){return this.backgroundNode};Track.prototype.init=function(){this._svg=this.createSVGDom(this.id,this.width,this.height,this.backgroundColor)};Track.prototype.clear=function(){if(null!=this.mainNodeGroup)for(;0<this.mainNodeGroup.childNodes.length;)this.mainNodeGroup.removeChild(this.mainNodeGroup.childNodes[0])};
Track.prototype._getSVGCoordenates=function(a){var c=this._svg.createSVGPoint();c.x=a.clientX;c.y=a.clientY;a=this._svg.getScreenCTM(document.documentElement);return c=c.matrixTransform(a.inverse())};FeatureTrack.prototype.createSVGDom=Track.prototype.createSVGDom;FeatureTrack.prototype.init=Track.prototype.init;FeatureTrack.prototype.mouseMove=Track.prototype.mouseMove;FeatureTrack.prototype.mouseUp=Track.prototype.mouseUp;FeatureTrack.prototype.mouseClick=Track.prototype.mouseClick;
FeatureTrack.prototype.mouseDown=Track.prototype.mouseDown;FeatureTrack.prototype._getViewBoxCoordenates=Track.prototype._getViewBoxCoordenates;FeatureTrack.prototype._goToCoordinate=Track.prototype._goToCoordinate;FeatureTrack.prototype._startDragging=Track.prototype._startDragging;FeatureTrack.prototype._dragging=Track.prototype._dragging;FeatureTrack.prototype._getSVGCoordenates=Track.prototype._getSVGCoordenates;FeatureTrack.prototype._stopDragging=Track.prototype._stopDragging;
FeatureTrack.prototype.clear=Track.prototype.clear;FeatureTrack.prototype.drawBackground=Track.prototype.drawBackground;
function FeatureTrack(a,c,b,d){Track.prototype.constructor.call(this,a,c,d);this.species=b;this.viewBoxModule=this.features=null;this.avoidOverlapping=!1;this.pixelSpaceBetweenBlocks=0;this.allowDuplicates=!0;this.featuresID={};this.showLabelsOnMiddleMarker=this.label=!1;this.forceColor=null;this.labelHeight=12;this.separatorBetweenQueue=4;null!=d&&(null!=d.showLabelsOnMiddleMarker&&(this.showLabelsOnMiddleMarker=d.showLabelsOnMiddleMarker),null!=d.queueHeight&&(this.queueHeight=d.queueHeight),null!=
d.labelHeight&&(this.labelHeight=d.labelHeight),null!=d.featureHeight&&(this.featureHeight=d.featureHeight),null!=d.forceColor&&(this.forceColor=d.forceColor),null!=d.avoidOverlapping&&(this.avoidOverlapping=d.avoidOverlapping),null!=d.pixelSpaceBetweenBlocks&&(this.pixelSpaceBetweenBlocks=d.pixelSpaceBetweenBlocks),null!=d.viewBoxModule&&(this.viewBoxModule=d.viewBoxModule),null!=d.allowDuplicates&&(this.allowDuplicates=d.allowDuplicates),null!=d.label&&(this.label=d.label));this.queues=[];this.queues[0]=
[];this.queueHeight=this.labelHeight+this.featureHeight;this.positions={};this.onClick=new Event(this);this.onMouseOver=new Event(this);this.onMouseOut=new Event(this);this.onMaximumHeightChanged=new Event(this)}FeatureTrack.prototype._overlapBlocks=function(a,c){var b=this.pixelSpaceBetweenBlocks/this.pixelRatio;return a.start<c.end+b&&a.end+b>c.start?!0:!1};FeatureTrack.prototype._setTextAttributes=function(a){return[["fill","black"],["id",this.id+"_"+a.id],["cursor","pointer"],["font-size",this.labelSize]]};
FeatureTrack.prototype._searchSpace=function(a){for(var c=0;c<this.queues.length;c++){for(var b=[],d=0;d<this.queues[c].length;d++){var e=this.queues[c][d];b.push(this._overlapBlocks(a,e));b.push(this._overlapBlocks(e,a))}if(-1==b.valueOf(b).indexOf(!0))return c}this.queues.push([]);return this.queues.length-1};FeatureTrack.prototype.drawLabelByPosition=function(){};FeatureTrack.prototype.appendFeatures=function(a){this.drawFeatures(a.toJSON())};
FeatureTrack.prototype.isFeatureDuplicated=function(a){return this.featuresID[a.start+"_"+a.end]};FeatureTrack.prototype.moveY=function(a){this.mainNodeGroup.setAttribute("transform","translate(0, "+a+")")};
FeatureTrack.prototype.drawFeatures=function(a){this.queues=[];this.queues.push([]);for(var c=0;c<a.length;c++){if(!this.allowDuplicates)if(this.isFeatureDuplicated(a[c]))continue;else this.featuresID[a[c].start+"_"+a[c].end]=!0;var b=0,b=this.avoidOverlapping?this._searchSpace(a[c]):0;this.queues[b].push(a[c]);this.drawFeaturesInQueue(a[c],b)}this._updateTop()};FeatureTrack.prototype.drawLabelAtPosition=function(){};
FeatureTrack.prototype.drawFeaturesInQueue=function(a,c){var b=this._setAttributes(a),d=(a.end-a.start+1)*this.pixelRatio;0>a.end-a.start&&(d=(a.start-a.end)*this.pixelRatio);var e=(a.start-1)*this.pixelRatio,f=this.top+c*this.featureHeight;this.label&&(f=this.top+c*(this.featureHeight+this.labelHeight+this.separatorBetweenQueue));this._drawFeature(e%this.viewBoxModule,f,Math.ceil(d),b,a)};
FeatureTrack.prototype._updateTop=function(){var a=this.height;this.avoidOverlapping&&(a=this.label?(this.featureHeight+this.labelHeight+this.separatorBetweenQueue)*this.queues.length:this.featureHeight*this.queues.length);this.maxHeight<a&&(this.maxHeight=a,this.onMaximumHeightChanged.notify());null!=this.backgroundNode&&this.backgroundNode.setAttribute("height",this.maxHeight);this.height=this.maxHeight};
FeatureTrack.prototype._getFeatureWidth=function(a){return 0==a.end-a.start?(a.end+1-a.start)*this.pixelRatio:(a.end-a.start)*this.pixelRatio};FeatureTrack.prototype._convertGenomePositionToPixelPosition=function(a){return(a-1)*this.pixelRatio%this.viewBoxModule};
FeatureTrack.prototype._setAttributes=function(a){var c=[["id",this.id+"_"+a.name],["style","cursor:pointer"]];c.push(["fill-opacity",a.getDefault().getOpacity()]);c.push(["stroke",a.getDefault().getStroke()]);c.push(["stroke-width",a.getDefault().getStrokeWidth()]);c.push(["stroke-opacity",a.getDefault().getStrokeOpacity()]);null==this.forceColor?c.push(["fill",a.getDefault().getFill()]):c.push(["fill",this.forceColor]);return c};
FeatureTrack.prototype._drawFeature=function(a,c,b,d,e){1>=b&&(b=2);this.positions[Math.ceil(a)]=!0;SVG.drawRectangle(Math.ceil(a),c,b,this.featureHeight,this.trackNodeGroup,d);this.label&&this._renderLabel(Math.ceil(a),Math.ceil(c)+(this.featureHeight+this.labelHeight),e.label,this._setTextAttributes(e),e)};
FeatureTrack.prototype._renderLabel=function(a,c,b,d,e){var f=this,a=SVG.drawText(a,c,b,this.labelNodeGroup,d);a.addEventListener("click",function(){f.onClick.notify(e);try{var a=[];for(key in e.feature)a.push(key);e instanceof SNPFeatureFormatter&&(new SnpInfoWidget(null,f.species)).draw(e);e instanceof VCFFeatureFormatter&&(new VCFVariantInfoWidget(null,f.species)).draw(e)}catch(b){console.log(b)}},!0);a.addEventListener("mouseover",function(a){f.tooltippanel=new TooltipPanel;f.tooltippanel.getPanel(e).showAt(a.clientX,
a.clientY)},!0);a.addEventListener("mouseout",function(){f.tooltippanel.destroy()},!0)};FeatureTrack.prototype.getIdToPrint=function(a){return a.id};FeatureTrack.prototype._render=function(){this.init();this.isAvalaible&&null!=this.features&&this.drawFeatures(this.features)};
FeatureTrack.prototype.moveTitle=function(a){if(this.title){var c=parseFloat(this.titleNodeGroup.getAttribute("moveX"));desplazamiento=c?parseFloat(parseFloat(a)+parseFloat(c)):a;this.titleNodeGroup.setAttribute("transform","translate("+-desplazamiento+", 0)");this.titleNodeGroup.setAttribute("moveX",desplazamiento)}};
FeatureTrack.prototype.drawTitle=function(a){a=this._convertGenomePositionToPixelPosition(a);null!=this.titleRectangle&&this.titleRectangle.parentNode.removeChild(this.titleRectangle);null!=this.titleText&&this.titleText.parentNode.removeChild(this.titleText);if(this.isAvalaible){var c=[["fill","#FFFFFF"],["stroke","#000000"],["opacity",0.7],["rx",4],["ry",4],["id"]];this.titleRectangle=SVG.drawRectangle(a,this.top,this.titleWidth,this.height,this.titleNodeGroup,c);this.titleText=SVG.drawText(a+2,
this.top+this.titleHeight-3,this.titleName,this.titleNodeGroup,[["font-size",this.titleFontSize]])}else c=[["fill","#FFFFCC"],["stroke","#000000"],["opacity",0.7],["rx",0],["ry",0]],SVG.drawRectangle(a,this.top,this.width,this.height,this.titleNodeGroup,c),SVG.drawText(a+2,this.top+this.height-4,this.titleName+": "+this.isNotAvalaibleMessage,this.titleNodeGroup,[["font-size",this.titleFontSize]])};FeatureTrack.prototype._addFeatures=function(a){this.features=a.toJSON();this.featuresIndex={}};
FeatureTrack.prototype.draw=function(a,c,b){this.top=b;null!=c&&(this._svg=c);null!=a.toJSON()&&this._addFeatures(a);this._render()};FeatureTrack.prototype.mouseclick=function(){};function SNPFeatureTrack(a,c,b,d){FeatureTrack.prototype.constructor.call(this,a,c,b,d);this.forceColor=this.opacity=null;null!=d&&(null!=d.opacity&&(this.opacity=d.opacity),null!=d.forceColor&&(this.forceColor=d.forceColor));this.positions={}}SNPFeatureTrack.prototype._renderLabel=FeatureTrack.prototype._renderLabel;
SNPFeatureTrack.prototype.getIdToPrint=FeatureTrack.prototype.getIdToPrint;SNPFeatureTrack.prototype.changeView=FeatureTrack.prototype.changeView;SNPFeatureTrack.prototype.render=FeatureTrack.prototype.render;SNPFeatureTrack.prototype.init=FeatureTrack.prototype.init;SNPFeatureTrack.prototype.createSVGDom=FeatureTrack.prototype.createSVGDom;SNPFeatureTrack.prototype._getTopText=FeatureTrack.prototype._getTopText;SNPFeatureTrack.prototype._getTopFeatures=FeatureTrack.prototype._getTopFeatures;
SNPFeatureTrack.prototype._searchSpace=FeatureTrack.prototype._searchSpace;SNPFeatureTrack.prototype.drawTitle=FeatureTrack.prototype.drawTitle;SNPFeatureTrack.prototype.mouseMove=FeatureTrack.prototype.mouseMove;SNPFeatureTrack.prototype.mouseclick=FeatureTrack.prototype.mouseclick;SNPFeatureTrack.prototype.getById=FeatureTrack.prototype.getById;SNPFeatureTrack.prototype.draw=FeatureTrack.prototype.draw;SNPFeatureTrack.prototype.drawFeatures=FeatureTrack.prototype.drawFeatures;
SNPFeatureTrack.prototype._overlapBlocks=FeatureTrack.prototype._overlapBlocks;SNPFeatureTrack.prototype._render=FeatureTrack.prototype._render;SNPFeatureTrack.prototype._convertGenomePositionToPixelPosition=FeatureTrack.prototype._convertGenomePositionToPixelPosition;SNPFeatureTrack.prototype._getViewBoxCoordenates=FeatureTrack.prototype._getViewBoxCoordenates;SNPFeatureTrack.prototype._getFeatureWidth=FeatureTrack.prototype._getFeatureWidth;SNPFeatureTrack.prototype._updateTop=FeatureTrack.prototype._updateTop;
SNPFeatureTrack.prototype.clear=FeatureTrack.prototype.clear;SNPFeatureTrack.prototype.drawBackground=FeatureTrack.prototype.drawBackground;SNPFeatureTrack.prototype.moveTitle=FeatureTrack.prototype.moveTitle;SNPFeatureTrack.prototype.appendFeatures=FeatureTrack.prototype.appendFeatures;SNPFeatureTrack.prototype.drawFeaturesInQueue=FeatureTrack.prototype.drawFeaturesInQueue;SNPFeatureTrack.prototype._setAttributes=FeatureTrack.prototype._setAttributes;
SNPFeatureTrack.prototype._setTextAttributes=FeatureTrack.prototype._setTextAttributes;SNPFeatureTrack.prototype.addFeatures=function(a){this.drawFeatures(a.toJSON())};SNPFeatureTrack.prototype._addFeatures=function(a){this.features=a.toJSON();this.featuresIndex={}};
SNPFeatureTrack.prototype._drawFeature=function(a,c,b,d,e){1>=b&&(b=2);this.positions[Math.ceil(a)]=!0;SVG.drawRectangle(Math.ceil(a),c,b,this.featureHeight,this.trackNodeGroup,d);if(this.label&&(this._renderLabel(Math.ceil(a),Math.ceil(c)+(this.featureHeight+this.labelHeight),e.label,this._setTextAttributes(e),e),null!=e.base))for(var d=e.base.length,b=b/d,f=0;f<d;f++)SVG.drawText(f*b+a+2,Math.ceil(c)+8,e.base[f],this.labelNodeGroup,[["font-size","8"],["fill","black"]])};
VCFFeatureTrack.prototype.getIdToPrint=FeatureTrack.prototype.getIdToPrint;VCFFeatureTrack.prototype.changeView=FeatureTrack.prototype.changeView;VCFFeatureTrack.prototype.render=FeatureTrack.prototype.render;VCFFeatureTrack.prototype.init=FeatureTrack.prototype.init;VCFFeatureTrack.prototype.createSVGDom=FeatureTrack.prototype.createSVGDom;VCFFeatureTrack.prototype._getTopText=FeatureTrack.prototype._getTopText;VCFFeatureTrack.prototype._getTopFeatures=FeatureTrack.prototype._getTopFeatures;
VCFFeatureTrack.prototype._searchSpace=FeatureTrack.prototype._searchSpace;VCFFeatureTrack.prototype.drawTitle=FeatureTrack.prototype.drawTitle;VCFFeatureTrack.prototype.mouseMove=FeatureTrack.prototype.mouseMove;VCFFeatureTrack.prototype.mouseclick=FeatureTrack.prototype.mouseclick;VCFFeatureTrack.prototype.getById=FeatureTrack.prototype.getById;VCFFeatureTrack.prototype.draw=FeatureTrack.prototype.draw;VCFFeatureTrack.prototype.getFeatureColor=FeatureTrack.prototype.getFeatureColor;
VCFFeatureTrack.prototype.drawFeatures=FeatureTrack.prototype.drawFeatures;VCFFeatureTrack.prototype._overlapBlocks=FeatureTrack.prototype._overlapBlocks;VCFFeatureTrack.prototype._render=FeatureTrack.prototype._render;VCFFeatureTrack.prototype._convertGenomePositionToPixelPosition=FeatureTrack.prototype._convertGenomePositionToPixelPosition;VCFFeatureTrack.prototype._getViewBoxCoordenates=FeatureTrack.prototype._getViewBoxCoordenates;VCFFeatureTrack.prototype._getFeatureWidth=FeatureTrack.prototype._getFeatureWidth;
VCFFeatureTrack.prototype.clear=FeatureTrack.prototype.clear;VCFFeatureTrack.prototype.drawBackground=FeatureTrack.prototype.drawBackground;VCFFeatureTrack.prototype.moveTitle=FeatureTrack.prototype.moveTitle;VCFFeatureTrack.prototype._setAttributes=FeatureTrack.prototype._setAttributes;VCFFeatureTrack.prototype._setTextAttributes=FeatureTrack.prototype._setTextAttributes;VCFFeatureTrack.prototype._updateTop=FeatureTrack.prototype._updateTop;VCFFeatureTrack.prototype.drawFeaturesInQueue=FeatureTrack.prototype.drawFeaturesInQueue;
VCFFeatureTrack.prototype._renderLabel=FeatureTrack.prototype._renderLabel;function VCFFeatureTrack(a,c,b){FeatureTrack.prototype.constructor.call(this,a,c,b);this.positions={};this.counter=0;console.log(this.featureHeight)}VCFFeatureTrack.prototype.appendFeatures=function(a){this.drawFeatures(a.toJSON())};VCFFeatureTrack.prototype._addFeatures=function(a){this.features=a.toJSON();this.featuresIndex={}};
VCFFeatureTrack.prototype._drawFeature=function(a,c,b,d,e){1>=b&&(b=2);this.positions[Math.ceil(a)]=!0;SVG.drawRectangle(Math.ceil(a),c,b,this.featureHeight,this.trackNodeGroup,d);if(null!=e.base)for(var d=e.base.length,b=b/d,f=0;f<d;f++)SVG.drawText(f*b+a+2,Math.ceil(c)+8,e.base[f],this.labelNodeGroup,[["font-size","8"],["fill","#ffffff"]]);this.label&&this._renderLabel(Math.ceil(a),Math.ceil(c)+(this.featureHeight+this.labelHeight),e.label,this._setTextAttributes(e),e)};
function GeneFeatureTrack(a,c,b){FeatureTrack.prototype.constructor.call(this,a,c,b);this.forceColor=this.opacity=null;null!=b&&(null!=b.opacity&&(this.opacity=b.opacity),null!=b.forceColor&&(this.forceColor=b.forceColor))}GeneFeatureTrack.prototype.isFeatureDuplicated=FeatureTrack.prototype.isFeatureDuplicated;GeneFeatureTrack.prototype.getIdToPrint=FeatureTrack.prototype.getIdToPrint;GeneFeatureTrack.prototype.changeView=FeatureTrack.prototype.changeView;GeneFeatureTrack.prototype.render=FeatureTrack.prototype.render;
GeneFeatureTrack.prototype.init=FeatureTrack.prototype.init;GeneFeatureTrack.prototype.createSVGDom=FeatureTrack.prototype.createSVGDom;GeneFeatureTrack.prototype._getTopText=FeatureTrack.prototype._getTopText;GeneFeatureTrack.prototype._getTopFeatures=FeatureTrack.prototype._getTopFeatures;GeneFeatureTrack.prototype._searchSpace=FeatureTrack.prototype._searchSpace;GeneFeatureTrack.prototype.drawTitle=FeatureTrack.prototype.drawTitle;GeneFeatureTrack.prototype.mouseMove=FeatureTrack.prototype.mouseMove;
GeneFeatureTrack.prototype.mouseclick=FeatureTrack.prototype.mouseclick;GeneFeatureTrack.prototype.getById=FeatureTrack.prototype.getById;GeneFeatureTrack.prototype.draw=FeatureTrack.prototype.draw;GeneFeatureTrack.prototype.getFeatureColor=FeatureTrack.prototype.getFeatureColor;GeneFeatureTrack.prototype.drawFeatures=FeatureTrack.prototype.drawFeatures;GeneFeatureTrack.prototype._overlapBlocks=FeatureTrack.prototype._overlapBlocks;GeneFeatureTrack.prototype.mouseMove=FeatureTrack.prototype.mouseMove;
GeneFeatureTrack.prototype.mouseUp=FeatureTrack.prototype.mouseUp;GeneFeatureTrack.prototype.mouseClick=FeatureTrack.prototype.mouseClick;GeneFeatureTrack.prototype.mouseDown=FeatureTrack.prototype.mouseDown;GeneFeatureTrack.prototype._render=FeatureTrack.prototype._render;GeneFeatureTrack.prototype._addFeatures=FeatureTrack.prototype._addFeatures;GeneFeatureTrack.prototype._setAttributes=FeatureTrack.prototype._setAttributes;GeneFeatureTrack.prototype._convertGenomePositionToPixelPosition=FeatureTrack.prototype._convertGenomePositionToPixelPosition;
GeneFeatureTrack.prototype._getViewBoxCoordenates=FeatureTrack.prototype._getViewBoxCoordenates;GeneFeatureTrack.prototype._getFeatureWidth=FeatureTrack.prototype._getFeatureWidth;GeneFeatureTrack.prototype._updateTop=FeatureTrack.prototype._updateTop;GeneFeatureTrack.prototype.clear=FeatureTrack.prototype.clear;GeneFeatureTrack.prototype.drawBackground=FeatureTrack.prototype.drawBackground;GeneFeatureTrack.prototype.moveTitle=FeatureTrack.prototype.moveTitle;
GeneFeatureTrack.prototype.addFeatures=function(a){this.drawFeatures(a.toJSON())};GeneFeatureTrack.prototype._addFeatures=function(a){this.features=a.toJSON();this.featuresIndex={}};
GeneFeatureTrack.prototype._setAttributes=function(a){var c=[["id",this.id],["font-size",a.getDefault().args.fontSize]];null==this.opacity?c.push(["opacity",a.getDefault().getOpacity()]):c.push(["opacity",this.opacity]);null==this.forceColor?c.push(["fill",a.getDefault().getFill()]):c.push(["fill",this.forceColor]);c.push(["stroke","black"]);c.push(["stroke-width","1"]);return c};
GeneFeatureTrack.prototype._setTextAttributes=function(a){this.getFeatureColor(a);return[["fill","black"],["id",this.id+"_"+a.start],["font-size",a.getDefault().args.fontSize]]};GeneFeatureTrack.prototype._drawFeature=function(a,c,b,d){SVG.drawRectangle(Math.ceil(a),Math.ceil(c),b,this.featureHeight,this.trackNodeGroup,d).addEventListener("mouseover",function(){},!0)};
function TrackCanvas(a,c,b){this.tracksGroup=null;this.targetID=c.id;this.args=b;this.top=0;this.left=100;this.right=900;this.width=1100;this.height=50;this.startViewBox=b.start;this.endViewBox=b.end;this.trackList=[];this.trackRendered=[];this.trackRenderedName=[];this.regionAdapterList=[];this.pixelRatio=5;this.zoom=1;this.viewBoxModule=700;this.isDragging=this.allowDragging=!1;this.dragPoint=null;this.backgroundColor="#FFFFFF";this.titleColor="#000000";this.title=this.overflow=!1;this.titleName=
null;this.titleFontSize=10;this.enableMovingY=!1;this.isBeenRenderized=this.allowLabelMoving=!0;null!=b&&(null!=b.top&&(this.top=b.top),null!=b.left&&(this.left=b.left),null!=b.right&&(this.right=b.right),null!=b.width&&(this.width=b.width),null!=b.height&&(this.height=b.height),null!=b.backgroundColor&&(this.backgroundColor=b.backgroundColor),null!=b.titleFontSize&&(this.titleFontSize=b.titleFontSize),null!=b.allowDragging&&(this.allowDragging=b.allowDragging),null!=b.titleColor&&(this.titleColor=
b.titleColor),null!=b.title&&(this.title=!0,this.titleName=b.title),null!=b.overflow&&(this.overflow=b.overflow),null!=b.pixelRatio&&(this.pixelRatio=b.pixelRatio),null!=b.viewBoxModule&&(this.viewBoxModule=b.viewBoxModule),null!=b.zoom&&(this.zoom=b.zoom));this.textLines=[];this.id=a;this.idMain=this.id+"_Main";this.moveY=0;this.onMove=new Event(this);this.afterDrag=new Event(this);this.onRender=new Event(this)}
TrackCanvas.prototype.createSVGDom=function(a,c){var b=DOM.select(a);this._svg=SVG.createSVGCanvas(b,[["viewBox","0 10 "+this.width+" "+this.height],["preserveAspectRatio","none"],["id",c],["height",this.height],["width",this.width],["background-color","green"]]);this.tracksGroup=SVG.drawGroup(this._svg,[["id",this.idMain],["transform","scale("+this.zoom+")"]]);SVG.drawRectangle(0,0,this.viewBoxModule,this.height,this.tracksGroup,[["fill","white"]]);return this._svg};
TrackCanvas.prototype.mouseClick=function(){alert("click")};TrackCanvas.prototype.mouseMove=function(a){this.allowDragging&&(this._dragging(a),this.moveLabelsFeatureSelected())};TrackCanvas.prototype.moveLabelsFeatureSelected=function(){if(this.allowLabelMoving)for(var a=0;a<this.trackList.length;a++)this.trackList[a].showLabelsOnMiddleMarker&&this.trackList[a].drawLabelAtPosition(this.getMiddlePoint(),this.regionAdapterList[a].getFeaturesByPosition(this.getMiddlePoint()))};
TrackCanvas.prototype.mouseDown=function(a){this.allowDragging&&this._startDragging(a)};TrackCanvas.prototype.mouseUp=function(a){this.allowDragging&&this._afterDrag(a)};
TrackCanvas.prototype.init=function(){this._svg=this.createSVGDom(this.targetID,this.id,this.width,this.height,this.backgroundColor);var a=this;this._svg.addEventListener("mousemove",function(c){a.mouseMove(c,a)},!1);this._svg.addEventListener("mousedown",function(c){a.mouseDown(c,a)},!1);this._svg.addEventListener("mouseup",function(c){a.mouseUp(c,a)},!1)};
TrackCanvas.prototype._getTrackFromInternalRegionId=function(a){for(var c=0;c<this.regionAdapterList.length;c++)if(null!=this.regionAdapterList[c]&&this.regionAdapterList[c].internalId==a)return this.trackList[c];return null};
TrackCanvas.prototype._formatData=function(a){a instanceof DasRegionDataAdapter&&console.log("regionAdapter instanceof DasRegionDataAdapter");if(a instanceof GeneRegionCellBaseDataAdapter){var c=new GeneBlockManager;a.dataset.json=c.toDatasetFormatter(a.dataset.json)}if(a instanceof VCFLocalRegionDataAdapter){for(var c=[],b=0;b<a.dataset.json[0].length;b++)c.push(new VCFFeatureFormatter(a.dataset.json[0][b]));a.dataset.json=c}if(a instanceof GFFLocalRegionDataAdapter){c=[];for(b=0;b<a.dataset.json[0].length;b++)c.push(new GFFFeatureFormatter(a.dataset.json[0][b]));
a.dataset.json=c}if(a instanceof BEDLocalRegionDataAdapter){c=[];for(b=0;b<a.dataset.json[0].length;b++)c.push(new BEDFeatureFormatter(a.dataset.json[0][b]));a.dataset.json=c}if(a instanceof RuleRegionDataAdapter){c=[];for(b=0;b<a.dataset.json[0].length;b++)c.push(new MarkerRuleFeatureFormatter(a.dataset.json[0][b]));a.dataset.json=c}if(a instanceof RegionCellBaseDataAdapter){c=[];if(-1!=a.resource.toLowerCase().indexOf("histogram=true"))return a;if("gene"==a.resource){c=[];for(b=0;b<a.dataset.json[0].length;b++)c.push(new GeneFeatureFormatter(a.dataset.json[0][b]))}if("tfbs"==
a.resource){c=[];for(b=0;b<a.dataset.json[0].length;b++)c.push(new TfbsFeatureFormatter(a.dataset.json[0][b]))}if("mirnatarget"==a.resource){c=[];for(b=0;b<a.dataset.json[0].length;b++)c.push(new MiRNAFeatureFormatter(a.dataset.json[0][b]))}if("regulatory?type=open chromatin"==a.resource){c=[];for(b=0;b<a.dataset.json[0].length;b++)c.push(new GenericFeatureFormatter(a.dataset.json[0][b]))}if("regulatory?type=HISTONE"==a.resource){c=[];for(b=0;b<a.dataset.json[0].length;b++)c.push(new GenericFeatureFormatter(a.dataset.json[0][b]))}if("regulatory?type=Polymerase"==
a.resource){c=[];for(b=0;b<a.dataset.json[0].length;b++)c.push(new GenericFeatureFormatter(a.dataset.json[0][b]))}if("snp"==a.resource){c=[];for(b=0;b<a.dataset.json[0].length;b++)c.push(new SNPFeatureFormatter(a.dataset.json[0][b]))}if("cytoband"==a.resource){c=[];for(b=0;b<a.dataset.json[0].length;b++)c.push(new CytobandFeatureFormatter(a.dataset.json[0][b]))}if("transcript"==a.resource){c=[];for(b=0;b<a.dataset.json[0].length;b++)c.push(new TranscriptFeatureFormatter(a.dataset.json[0][b]))}if("exon"==
a.resource){c=[];for(b=0;b<a.dataset.json[0].length;b++)c.push(new ExonFeatureFormatter(a.dataset.json[0][b]))}if("conservedregion"==a.resource){c=[];for(b=0;b<a.dataset.json[0].length;b++)c.push(new GenericFeatureFormatter(a.dataset.json[0][b]))}if("sequence"==a.resource){c=[];for(b=0;b<a.dataset.json[0].sequence.length;b++){var d=a.dataset.json[0].start+b+1;c.push(new SequenceFormatter({start:d,end:d,base:a.dataset.json[0].sequence[b]}))}}a.dataset.json=c}return a};
TrackCanvas.prototype._trackRendered=function(){for(var a=0;a<this.trackRendered.length;a++)if(!1==this.trackRendered[a]){this.trackRendered[a]=!0;break}};TrackCanvas.prototype._areAllTracksRendered=function(){for(var a=0;a<this.trackRendered.length;a++)if(!1==this.trackRendered[a])return!1;return!0};
TrackCanvas.prototype._drawTrack=function(a,c,b,d,e){var f=this;d.viewBoxModule=this.viewBoxModule;d.isAvalaible?(e.successed.addEventListener(function(){f._formatData(e);f.trackRenderedName.push(e);f._trackRendered();f._areAllTracksRendered()&&f.drawRules(a,c,b)}),e.preloadSuccess.addEventListener(function(a){a=f._getTrackFromInternalRegionId(a.internalId);e=f._formatData(e);a.appendFeatures(e.dataset)}),this.onMove.addEventListener(function(b,c){c.middle=Math.ceil(c.middle)+1;e.setIntervalView(a,
Math.ceil(c.middle));e instanceof RuleRegionDataAdapter&&f.selectPaintOnRules(c.middle)}),e.fill(a,c,b,e.resource)):(f.trackRenderedName.push(e),f._trackRendered())};TrackCanvas.prototype.selectPaintOnRules=function(a){for(var c=0;c<this.getRuleTracks().length;c++)1>this.pixelRatio?this.getRuleTracks()[c].select(a):this.getRuleTracks()[c].select(a,{width:this.pixelRatio})};
TrackCanvas.prototype.getRuleTracks=function(){for(var a=[],c=0;c<this.trackList.length;c++)this.trackList[c]instanceof RuleFeatureTrack&&a.push(this.trackList[c]);return a};TrackCanvas.prototype.getMiddlePoint=function(){return Math.ceil(this.middle)+1};
TrackCanvas.prototype.drawRules=function(){for(var a=0;a<this.trackList.length;a++){var c=this._getTopTrack(this.trackList[a]);this.trackList[a].draw(this.regionAdapterList[a].dataset,this.tracksGroup,c);this._drawTitle(a)}this._goToCoordinateX(this.start);this.onRender.notify()};
TrackCanvas.prototype._drawTitle=function(a){if(null!=this.trackList[a].title){var c=this.start+this.width/this.pixelRatio/2;null==c?this.trackList[a].drawTitle(10):this.trackList[a].drawTitle(c-this.width/2/this.pixelRatio+1)}};
TrackCanvas.prototype.draw=function(a,c,b){this.start=c;this.end=b;this.chromosome=a;this.startViewBox=c*this.pixelRatio%this.viewBoxModule;this.endViewBox=b*this.pixelRatio%this.viewBoxModule;for(var d=0;d<this.regionAdapterList.length;d++){var e=this.trackList[d],f=this.regionAdapterList[d];f.successed=new Event(f);f.preloadSuccess=new Event(f);this._drawTrack(a,c,b,e,f)}};TrackCanvas.prototype.clear=function(){DOM.removeChilds(this.targetID)};
TrackCanvas.prototype.addTrack=function(a,c){this.trackList.push(a);this.trackRendered.push(!1);this.regionAdapterList.push(c)};TrackCanvas.prototype._getTopTrack=function(a){for(var c=this.top,b=0;b<this.trackList.length;b++){if(this.trackList[b].internalId==a.internalId)return c+this.trackList[b].top;c=c+this.trackList[b].height+this.trackList[b].originalTop}return c};
TrackCanvas.prototype._goToCoordinateX=function(a){this.start=a;this._svg.setAttribute("viewBox",this.start*this.pixelRatio%this.viewBoxModule+" 10 "+this.width+" "+this.height);this.isBeenRenderized?(this.middle=this.start+(this.end-this.start)/2,this.isBeenRenderized=!1):this.middle=this.start+this.width/this.pixelRatio/2;this.onMove.notify({chromosome:this.chromosome,start:this.start,end:this.end,middle:this.middle})};
TrackCanvas.prototype._moveCoordinateX=function(a){for(var c=0;c<this.trackList.length;c++)null!=this.trackList[c].title&&this.trackList[c].moveTitle(-a);this._goToCoordinateX(Math.ceil(this.start+a/this.pixelRatio))};TrackCanvas.prototype._moveCoordinateY=function(a){a=-1*a+this.moveY;if(a<this.top){this.tracksGroup.setAttribute("transform","translate(0, "+a+")");this.realMove=a;for(var c=0;c<this.trackList.length;c++)this.trackList[c].floating&&this.trackList[c].moveY(-a)}else this.realMove=0};
TrackCanvas.prototype._startDragging=function(a){this.isDragging=!0;a=this._getSVGCoordenates(a);this.dragPoint={x:a.x,y:a.y}};TrackCanvas.prototype._afterDrag=function(){this.isDragging=!1;this.dragPoint=null;this.moveY=this.realMove;this.afterDrag.notify(this.middle)};TrackCanvas.prototype.setZoom=function(a){this.zoom=a;this.tracksGroup.setAttribute("transform","scale("+a+")");this._goToCoordinateX(this.startViewBox)};
TrackCanvas.prototype._dragging=function(a){if(this.isDragging){var a=this._getSVGCoordenates(a),c=this.dragPoint.y-a.y;this._moveCoordinateX(this.dragPoint.x-a.x);this.enableMovingY&&this._moveCoordinateY(Math.ceil(c))}};TrackCanvas.prototype._getSVGCoordenates=function(a){var c=this._svg.createSVGPoint();c.x=a.clientX;c.y=a.clientY;a=this._svg.getScreenCTM(document.documentElement);return c=c.matrixTransform(a.inverse())};
function SequenceFeatureTrack(a,c,b,d){FeatureTrack.prototype.constructor.call(this,a,c,b,d);this.avoidOverlapping=!1}SequenceFeatureTrack.prototype.getIdToPrint=FeatureTrack.prototype.getIdToPrint;SequenceFeatureTrack.prototype.changeView=FeatureTrack.prototype.changeView;SequenceFeatureTrack.prototype.render=FeatureTrack.prototype.render;SequenceFeatureTrack.prototype.init=FeatureTrack.prototype.init;SequenceFeatureTrack.prototype.createSVGDom=FeatureTrack.prototype.createSVGDom;
SequenceFeatureTrack.prototype._getTopText=FeatureTrack.prototype._getTopText;SequenceFeatureTrack.prototype._getTopFeatures=FeatureTrack.prototype._getTopFeatures;SequenceFeatureTrack.prototype._searchSpace=FeatureTrack.prototype._searchSpace;SequenceFeatureTrack.prototype.drawTitle=FeatureTrack.prototype.drawTitle;SequenceFeatureTrack.prototype.mouseMove=FeatureTrack.prototype.mouseMove;SequenceFeatureTrack.prototype.mouseclick=FeatureTrack.prototype.mouseclick;
SequenceFeatureTrack.prototype.getById=FeatureTrack.prototype.getById;SequenceFeatureTrack.prototype.draw=FeatureTrack.prototype.draw;SequenceFeatureTrack.prototype.drawFeatures=FeatureTrack.prototype.drawFeatures;SequenceFeatureTrack.prototype._overlapBlocks=FeatureTrack.prototype._overlapBlocks;SequenceFeatureTrack.prototype.mouseMove=FeatureTrack.prototype.mouseMove;SequenceFeatureTrack.prototype.mouseUp=FeatureTrack.prototype.mouseUp;SequenceFeatureTrack.prototype.mouseClick=FeatureTrack.prototype.mouseClick;
SequenceFeatureTrack.prototype.mouseDown=FeatureTrack.prototype.mouseDown;SequenceFeatureTrack.prototype._render=FeatureTrack.prototype._render;SequenceFeatureTrack.prototype._convertGenomePositionToPixelPosition=FeatureTrack.prototype._convertGenomePositionToPixelPosition;SequenceFeatureTrack.prototype._getFeatureWidth=FeatureTrack.prototype._getFeatureWidth;SequenceFeatureTrack.prototype._updateTop=FeatureTrack.prototype._updateTop;SequenceFeatureTrack.prototype.clear=FeatureTrack.prototype.clear;
SequenceFeatureTrack.prototype.drawBackground=FeatureTrack.prototype.drawBackground;SequenceFeatureTrack.prototype.moveTitle=FeatureTrack.prototype.moveTitle;SequenceFeatureTrack.prototype.drawFeaturesInQueue=FeatureTrack.prototype.drawFeaturesInQueue;SequenceFeatureTrack.prototype.appendFeatures=function(a){this.features=a.toJSON();this.drawFeatures(this.features)};SequenceFeatureTrack.prototype._addFeatures=function(a){this.features=a.toJSON();this.featuresIndex={}};
SequenceFeatureTrack.prototype._setAttributes=function(a){a=[["fill",a.getDefault().getFill()],["id",this.id+"_"+a.start],["font-size","10"]];a.push(["opacity","1"]);return a};SequenceFeatureTrack.prototype._drawFeature=function(a,c,b,d,e){d.push(["opacity",0.8]);d.push(["stroke","black"]);SVG.drawRectangle(a,Math.ceil(c),this.pixelRatio,this.featureHeight,this.trackNodeGroup,d);SVG.drawText(a+2,Math.ceil(c)+8,e.label,this.labelNodeGroup,[["font-size","8"]])};
SequenceFeatureTrack.prototype.getTextId=function(a){return"id_seq_"+a};SequenceFeatureTrack.prototype._textId=function(a,c,b,d,e){SVG.drawText(Math.ceil(a)+2,Math.ceil(c)+8,e.base,this.trackNodeGroup,[["font-size","8"],["id",this.getTextId(a)]])};SequenceFeatureTrack.prototype._removeTextBase=function(a){this.trackNodeGroup.removeChild(DOM.select(this.getTextId(a)))};
SequenceFeatureTrack.prototype._drawTextBase=function(a,c,b,d,e){SVG.drawText(Math.ceil(a)+2,Math.ceil(c)+8,e.base,this.trackNodeGroup,[["font-size","8"],["id","id_seq_"+a]])};
function RuleFeatureTrack(a,c,b,d){FeatureTrack.prototype.constructor.call(this,a,c,b,d);this.horizontalRuleDrawn=!1;this.expandRuleHeight=this.ruleHeight=this.height;this.horizontalRuleTop=this.height-2;null!=d&&(null!=d.expandRuleHeight&&(this.ruleHeight=d.expandRuleHeight),null!=d.space&&(this.space=d.space));this.allowDuplicates=!0;this.quarter=(this.end-this.start)/4;this.selectedMiddleLine=null}RuleFeatureTrack.prototype.getIdToPrint=FeatureTrack.prototype.getIdToPrint;
RuleFeatureTrack.prototype.render=FeatureTrack.prototype.render;RuleFeatureTrack.prototype._getTopText=FeatureTrack.prototype._getTopText;RuleFeatureTrack.prototype._getTopFeatures=FeatureTrack.prototype._getTopFeatures;RuleFeatureTrack.prototype._searchSpace=FeatureTrack.prototype._searchSpace;RuleFeatureTrack.prototype.drawTitle=FeatureTrack.prototype.drawTitle;RuleFeatureTrack.prototype.mouseMove=FeatureTrack.prototype.mouseMove;RuleFeatureTrack.prototype.mouseclick=FeatureTrack.prototype.mouseclick;
RuleFeatureTrack.prototype.getById=FeatureTrack.prototype.getById;RuleFeatureTrack.prototype.draw=FeatureTrack.prototype.draw;RuleFeatureTrack.prototype.drawFeatures=FeatureTrack.prototype.drawFeatures;RuleFeatureTrack.prototype._overlapBlocks=FeatureTrack.prototype._overlapBlocks;RuleFeatureTrack.prototype.mouseMove=FeatureTrack.prototype.mouseMove;RuleFeatureTrack.prototype.mouseUp=FeatureTrack.prototype.mouseUp;RuleFeatureTrack.prototype.mouseClick=FeatureTrack.prototype.mouseClick;
RuleFeatureTrack.prototype.mouseDown=FeatureTrack.prototype.mouseDown;RuleFeatureTrack.prototype._convertGenomePositionToPixelPosition=FeatureTrack.prototype._convertGenomePositionToPixelPosition;RuleFeatureTrack.prototype._render=FeatureTrack.prototype._render;RuleFeatureTrack.prototype._getFeatureWidth=FeatureTrack.prototype._getFeatureWidth;RuleFeatureTrack.prototype._updateTop=FeatureTrack.prototype._updateTop;RuleFeatureTrack.prototype.drawBackground=FeatureTrack.prototype.drawBackground;
RuleFeatureTrack.prototype.isFeatureDuplicated=FeatureTrack.prototype.isFeatureDuplicated;RuleFeatureTrack.prototype.clear=FeatureTrack.prototype.clear;RuleFeatureTrack.prototype.init=FeatureTrack.prototype.init;RuleFeatureTrack.prototype.createSVGDom=FeatureTrack.prototype.createSVGDom;RuleFeatureTrack.prototype.moveY=FeatureTrack.prototype.moveY;RuleFeatureTrack.prototype._setAttributes=FeatureTrack.prototype._setAttributes;RuleFeatureTrack.prototype.moveTitle=FeatureTrack.prototype.moveTitle;
RuleFeatureTrack.prototype.drawFeaturesInQueue=FeatureTrack.prototype.drawFeaturesInQueue;RuleFeatureTrack.prototype.appendFeatures=function(a){this.drawFeatures(a.toJSON())};RuleFeatureTrack.prototype._addFeatures=function(a){this.features=a.toJSON();this.horizontalRuleDrawn=!1};RuleFeatureTrack.prototype.getFeatureColor=function(){return"#000000"};
RuleFeatureTrack.prototype.select=function(a,c){var b=1;null!=c&&null!=c.width&&(b=c.width);null!=this.selectedMiddleLine&&this.selectedMiddleLine.parentNode.removeChild(this.selectedMiddleLine);null!=this.textMiddleLine&&this.textMiddleLine.parentNode.removeChild(this.textMiddleLine);if(null!=this.trackNodeGroup){var d=this._convertGenomePositionToPixelPosition(a);this.selectedMiddleLine=SVG.drawRectangle(d,this.top+this.horizontalRuleTop,b,this.ruleHeight+1E4,this.trackNodeGroup,[["fill","green"],
["stroke-width","1"],["opacity",0.5]]);this.textMiddleLine=SVG.drawText(Math.ceil(d)-15,this.top+this.horizontalRuleTop,this._prettyNumber(a),this.trackNodeGroup,[["font-size","9"],["fill","green"]])}};
RuleFeatureTrack.prototype._drawFeature=function(a,c,b,d,e){null!=this.trackNodeGroup&&(e.isLabeled?(SVG.drawText(Math.ceil(a)+2,c+10,this._prettyNumber(e.start),this.labelNodeGroup,[["font-size","10"]]),SVG.drawLine(Math.ceil(a),c,Math.ceil(a),this.ruleHeight+1E4,this.trackNodeGroup,[["stroke","#000000"],["opacity",e.getDefault().getOpacity()]])):SVG.drawLine(Math.ceil(a),c+this.horizontalRuleTop,Math.ceil(a),this.ruleHeight+1E4,this.trackNodeGroup,[["stroke","#000000"],["opacity",e.getDefault().getOpacity()]]),
this.horizontalRuleDrawn||(a=this.viewBoxModule,26E7*this.pixelRatio<this.viewBoxModule&&(a=26E7*this.pixelRatio),SVG.drawRectangle(0,c,a,this.height,this.trackNodeGroup,[["fill","gray"],["stroke","#000000"],["opacity",0.5]]),this.horizontalRuleDrawn=!0))};RuleFeatureTrack.prototype._prettyNumber=function(a){a=Math.ceil(a)+"";x=a.split(".");x1=x[0];x2=1<x.length?"."+x[1]:"";for(a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");return x1+x2};
function MultiFeatureTrack(a,c,b,d){FeatureTrack.prototype.constructor.call(this,a,c,b,d);this.queueHeight=14;this.pixelSpaceBetweenBlocks=80;this.avoidOverlapping=this.showTranscripts=!0;this.onMouseOverShitExonTranscriptLabel=this.showExonLabel=this.showDetailGeneLabel=!1;this.extraSpaceProducedByLabelAbove=6;this.geneBlockManager=null;this.labelHeight=12;this.separatorBetweenQueue=4;this.labelSize=18;null!=d&&(null!=d.showExonLabel&&(this.showExonLabel=d.showExonLabel),null!=d.onMouseOverShitExonTranscriptLabel&&
(this.onMouseOverShitExonTranscriptLabel=d.onMouseOverShitExonTranscriptLabel),null!=d.queueHeight&&(this.queueHeight=d.queueHeight),null!=d.labelSize&&(this.labelSize=d.labelSize),null!=d.labelHeight&&(this.labelHeight=d.labelHeight),null!=d.pixelSpaceBetweenBlocks&&(this.pixelSpaceBetweenBlocks=d.pixelSpaceBetweenBlocks),null!=d.showTranscripts&&(this.showTranscripts=d.showTranscripts),null!=d.labelsNearEye&&(this.labelsNearEye=d.labelsNearEye),null!=d.showDetailGeneLabel&&(this.showDetailGeneLabel=
d.showDetailGeneLabel));this.queues=[];this.queues.push([])}MultiFeatureTrack.prototype.getIdToPrint=FeatureTrack.prototype.getIdToPrint;MultiFeatureTrack.prototype.changeView=FeatureTrack.prototype.changeView;MultiFeatureTrack.prototype.init=FeatureTrack.prototype.init;MultiFeatureTrack.prototype.createSVGDom=FeatureTrack.prototype.createSVGDom;MultiFeatureTrack.prototype._getTopText=FeatureTrack.prototype._getTopText;MultiFeatureTrack.prototype._getTopFeatures=FeatureTrack.prototype._getTopFeatures;
MultiFeatureTrack.prototype.select=FeatureTrack.prototype.select;MultiFeatureTrack.prototype.drawTitle=FeatureTrack.prototype.drawTitle;MultiFeatureTrack.prototype.mouseMove=FeatureTrack.prototype.mouseMove;MultiFeatureTrack.prototype.mouseclick=FeatureTrack.prototype.mouseclick;MultiFeatureTrack.prototype.getById=FeatureTrack.prototype.getById;MultiFeatureTrack.prototype.draw=FeatureTrack.prototype.draw;MultiFeatureTrack.prototype.getFeatureColor=FeatureTrack.prototype.getFeatureColor;
MultiFeatureTrack.prototype._overlapBlocks=FeatureTrack.prototype._overlapBlocks;MultiFeatureTrack.prototype.mouseMove=FeatureTrack.prototype.mouseMove;MultiFeatureTrack.prototype.mouseUp=FeatureTrack.prototype.mouseUp;MultiFeatureTrack.prototype.mouseClick=FeatureTrack.prototype.mouseClick;MultiFeatureTrack.prototype.mouseDown=FeatureTrack.prototype.mouseDown;MultiFeatureTrack.prototype._addFeatures=FeatureTrack.prototype._addFeatures;
MultiFeatureTrack.prototype._convertGenomePositionToPixelPosition=FeatureTrack.prototype._convertGenomePositionToPixelPosition;MultiFeatureTrack.prototype._getViewBoxCoordenates=FeatureTrack.prototype._getViewBoxCoordenates;MultiFeatureTrack.prototype._getFeatureWidth=FeatureTrack.prototype._getFeatureWidth;MultiFeatureTrack.prototype.drawBackground=FeatureTrack.prototype.drawBackground;MultiFeatureTrack.prototype.moveTitle=FeatureTrack.prototype.moveTitle;
MultiFeatureTrack.prototype._renderLabel=function(a,c,b,d){return SVG.drawText(a,c,b,this.labelNodeGroup,d)};
MultiFeatureTrack.prototype._setTextAttributes=function(a){var c=[["fill","black"],["id",this.id+"_"+a.id],["cursor","pointer"],["font-size",this.labelSize]];a instanceof TranscriptFeatureFormatter&&this.showExonLabel&&c.push(["opacity",0]);a instanceof ExonFeatureFormatter&&this.onMouseOverShitExonTranscriptLabel&&c.push(["opacity",0]);a instanceof ExonFeatureFormatter&&!this.showExonLabell&&c.push(["opacity",0]);return c};
MultiFeatureTrack.prototype.drawLabelAtPosition=function(a,c){for(var b=[],d=[],e=0;e<c.length;e++)null!=c[e+1]&&c[e+1]instanceof ExonFeatureFormatter?d.push(c[e].getId()):b.push(c[e].getId());for(e=0;e<this.labelNodeGroup.childElementCount;e++){this.labelNodeGroup.childNodes[e].setAttribute("opacity",0);for(var f=0;f<b.length;f++)-1!=b[f].indexOf(this.labelNodeGroup.childNodes[e].getAttribute("id").replace(this.id+"_",""))&&(this.labelNodeGroup.childNodes[e].setAttribute("x",this._convertGenomePositionToPixelPosition(a)),
this.labelNodeGroup.childNodes[e].setAttribute("opacity",1));for(f=0;f<d.length;f++)-1!=d[f].indexOf(this.labelNodeGroup.childNodes[e].getAttribute("id").replace(this.id+"_",""))&&this.labelNodeGroup.childNodes[e].setAttribute("opacity",0)}};
MultiFeatureTrack.prototype._updateTop=function(){var a=this.height;this.avoidOverlapping&&(a=this.label?(this.featureHeight+this.labelHeight+this.separatorBetweenQueue)*this.queues.length:this.featureHeight*this.queues.length);this.maxHeight<a&&(this.maxHeight=a,this.onMaximumHeightChanged.notify());null!=this.backgroundNode&&this.backgroundNode.setAttribute("height",this.maxHeight);this.height=this.maxHeight};MultiFeatureTrack.prototype.appendFeatures=function(a){this.drawFeatures(a.toJSON())};
MultiFeatureTrack.prototype.clear=function(){if(null!=this.mainNodeGroup)for(;0<this.mainNodeGroup.childNodes.length;)this.mainNodeGroup.removeChild(this.mainNodeGroup.childNodes[0]);this.featuresID={};this.maxHeight=this.originalHeight};
MultiFeatureTrack.prototype._addFeatures=function(a){null==this.geneBlockManager&&(this.geneBlockManager=new GeneBlockManager);this.features=0!=a.toJSON().lenth&&!a.toJSON()[0]instanceof GeneFeatureFormatter?this.geneBlockManager.toDatasetFormatter(a.toJSON()):a.toJSON();this.featuresIndex={}};
MultiFeatureTrack.prototype._setAttributes=function(a,c){var b=[["id",this.id+"_"+a.name],["style","cursor:pointer"]];b.push(["fill-opacity",a.getDefault().getOpacity()]);b.push(["stroke",a.getDefault().getStroke()]);b.push(["stroke-width",a.getDefault().getStrokeWidth()]);b.push(["stroke-opacity",a.getDefault().getStrokeOpacity()]);null!=c?c||b.push(["fill","white"]):null==this.forceColor?b.push(["fill",a.getDefault().getFill()]):b.push(["fill",this.forceColor]);return b};
MultiFeatureTrack.prototype._searchSpace=function(a,c){for(var b=c;b<this.queues.length;b++){for(var d=[],e=0;e<this.queues[b].length;e++){var f=this.queues[b][e];d.push(this._overlapBlocks(a,f));d.push(this._overlapBlocks(f,a))}if(-1==d.valueOf(d).indexOf(!0))return b}this.queues.push([]);return this.queues.length-1};MultiFeatureTrack.prototype.isFeatureDuplicated=function(a){return null!=this.featuresID[a.id]};
MultiFeatureTrack.prototype._render=function(){this.init();this.isAvalaible&&null!=this.features&&this.drawFeatures(this.features);this.queues=[];this.queues.push([])};
MultiFeatureTrack.prototype.drawFeatures=function(a){0<a.length&&!1==a[0]instanceof GeneFeatureFormatter&&(a=(new GeneBlockManager).toDatasetFormatter(a));for(var c=0;c<a.length;c++){var b=a[c];if(!this.allowDuplicates)if(this.isFeatureDuplicated(a[c]))continue;else this.featuresID[a[c].id]=!0;if(b instanceof GeneFeatureFormatter){var d=this._searchSpace(b,0);this.queues[d].push(b);this.drawFeaturesInQueue(b,d);if(null!=b.transcript&&this.showTranscripts)for(var e=0;e<b.transcript.length;e++){var f=
b.transcript[e],g=this._searchSpace(f,Math.ceil(d)+1);this.queues[g].push(f);this.drawFeaturesInQueue(f,g);for(var h=0;h<f.exon.length;h++)this.drawFeaturesInQueue(f.exon[h],g,f)}}}this._updateTop()};
MultiFeatureTrack.prototype.drawFeaturesInQueue=function(a,c,b){var d=(a.end-a.start+1)*this.pixelRatio,e=(a.start-1)*this.pixelRatio,f=this.top+c*this.featureHeight;this.label&&(f=this.top+c*(this.featureHeight+this.labelHeight+this.separatorBetweenQueue));if(null==b)this._drawFeature(e%this.viewBoxModule,f,Math.ceil(d),this._setAttributes(a),a);else{var c=e%this.viewBoxModule,e=this._setAttributes(a),g=this._setAttributes(a,!1);if(b.feature.codingRegionStart<=a.start&&b.feature.codingRegionEnd>=
a.end)this._drawFeature(c,f,Math.ceil(d),e,a);else if(a.start>=b.feature.codingRegionEnd||a.end<=b.feature.codingRegionStart)this._drawFeature(c,f,Math.ceil(d),g,a);else{var d=this._convertGenomePositionToPixelPosition(b.feature.codingRegionStart),h=this._convertGenomePositionToPixelPosition(b.feature.codingRegionEnd),i=this._convertGenomePositionToPixelPosition(a.start),j=this._convertGenomePositionToPixelPosition(a.end+1);a.start<=b.feature.codingRegionStart&&a.end<=b.feature.codingRegionEnd?(this._drawFeature(i,
f,d-c,g,a),this._drawFeature(d,f,j-d,e,a)):a.start>=b.feature.codingRegionStart&&a.end>=b.feature.codingRegionEnd?(this._drawFeature(h,f,j-h,g,a),this._drawFeature(i,f,h-i,e,a)):a.start<=b.feature.codingRegionStart&&a.end>=b.feature.codingRegionEnd&&(this._drawFeature(i,f,d-i,g,a),this._drawFeature(h,f,j-h,g,a),this._drawFeature(d,f,h-d,e,a))}}};
MultiFeatureTrack.prototype._drawFeature=function(a,c,b,d,e){var f=this;e instanceof TranscriptFeatureFormatter?SVG.drawLine(a,c+this.featureHeight/2,a+Math.ceil(b),c+this.featureHeight/2,this.trackNodeGroup,this._setAttributes(e)):(b=SVG.drawRectangle(Math.ceil(a),Math.ceil(c),b,this.featureHeight,this.trackNodeGroup,d),b.addEventListener("mouseover",function(a){f._featureOver(e,this,a)},!0),b.addEventListener("mouseout",function(a){f._featureOut(e,this,a)},!0),b.addEventListener("click",function(a){f.clickOn(e,
this,a)},!0));this.label&&(b=this.getLabel(e),null!=b&&(a=this._renderLabel(Math.ceil(a),Math.ceil(c)+(this.featureHeight+this.labelHeight),b,this._setTextAttributes(e)),a.addEventListener("mouseover",function(a){f._featureOver(e,this,a)},!0),a.addEventListener("mouseout",function(a){f._featureOut(e,this,a)},!0),a.addEventListener("click",function(a){f.clickOn(e,this,a)},!0)))};
MultiFeatureTrack.prototype.getLabel=function(a){var c=a.label;return a instanceof GeneFeatureFormatter&&this.showDetailGeneLabel?a.getDetailLabel():a instanceof ExonFeatureFormatter?this.showExonLabel?a.label:"":a instanceof TranscriptFeatureFormatter?a.label:c};MultiFeatureTrack.prototype.clickOn=function(a){a instanceof TranscriptFeatureFormatter&&(new TranscriptInfoWidget(null,this.species)).draw(a);a instanceof GeneFeatureFormatter&&(new GeneInfoWidget(null,this.species)).draw(a);this.onClick.notify(a)};
MultiFeatureTrack.prototype._featureOut=function(a,c){c.setAttribute("stroke-width","0.5");c.setAttribute("opacity",this.lastOpacity);this.tooltippanel.destroy()};MultiFeatureTrack.prototype._featureOver=function(a,c,b){this.lastOpacity=c.getAttribute("opacity");c.setAttribute("stroke-width","1");c.setAttribute("opacity","0.6");this.tooltippanel=new TooltipPanel;this.tooltippanel.getPanel(a).showAt(b.clientX,b.clientY)};
function CytobandFeatureTrack(a,c,b){FeatureTrack.prototype.constructor.call(this,a,c,b);this.forceColor=this.opacity=null;null!=b&&(null!=b.opacity&&(this.opacity=b.opacity),null!=b.forceColor&&(this.forceColor=b.forceColor));this.positions={}}CytobandFeatureTrack.prototype._renderLabel=FeatureTrack.prototype._renderLabel;CytobandFeatureTrack.prototype.isFeatureDuplicated=FeatureTrack.prototype.isFeatureDuplicated;CytobandFeatureTrack.prototype.getIdToPrint=FeatureTrack.prototype.getIdToPrint;
CytobandFeatureTrack.prototype.changeView=FeatureTrack.prototype.changeView;CytobandFeatureTrack.prototype.render=FeatureTrack.prototype.render;CytobandFeatureTrack.prototype.init=FeatureTrack.prototype.init;CytobandFeatureTrack.prototype.createSVGDom=FeatureTrack.prototype.createSVGDom;CytobandFeatureTrack.prototype._getTopText=FeatureTrack.prototype._getTopText;CytobandFeatureTrack.prototype._getTopFeatures=FeatureTrack.prototype._getTopFeatures;CytobandFeatureTrack.prototype._searchSpace=FeatureTrack.prototype._searchSpace;
CytobandFeatureTrack.prototype.drawTitle=FeatureTrack.prototype.drawTitle;CytobandFeatureTrack.prototype.mouseMove=FeatureTrack.prototype.mouseMove;CytobandFeatureTrack.prototype.mouseclick=FeatureTrack.prototype.mouseclick;CytobandFeatureTrack.prototype.getById=FeatureTrack.prototype.getById;CytobandFeatureTrack.prototype.draw=FeatureTrack.prototype.draw;CytobandFeatureTrack.prototype.drawFeatures=FeatureTrack.prototype.drawFeatures;CytobandFeatureTrack.prototype._overlapBlocks=FeatureTrack.prototype._overlapBlocks;
CytobandFeatureTrack.prototype._render=FeatureTrack.prototype._render;CytobandFeatureTrack.prototype._convertGenomePositionToPixelPosition=FeatureTrack.prototype._convertGenomePositionToPixelPosition;CytobandFeatureTrack.prototype._getViewBoxCoordenates=FeatureTrack.prototype._getViewBoxCoordenates;CytobandFeatureTrack.prototype._getFeatureWidth=FeatureTrack.prototype._getFeatureWidth;CytobandFeatureTrack.prototype._updateTop=FeatureTrack.prototype._updateTop;
CytobandFeatureTrack.prototype.clear=FeatureTrack.prototype.clear;CytobandFeatureTrack.prototype.drawBackground=FeatureTrack.prototype.drawBackground;CytobandFeatureTrack.prototype.moveTitle=FeatureTrack.prototype.moveTitle;CytobandFeatureTrack.prototype.moveY=FeatureTrack.prototype.moveY;CytobandFeatureTrack.prototype.drawFeaturesInQueue=FeatureTrack.prototype.drawFeaturesInQueue;CytobandFeatureTrack.prototype._setTextAttributes=FeatureTrack.prototype._setTextAttributes;
CytobandFeatureTrack.prototype._setAttributes=FeatureTrack.prototype._setAttributes;CytobandFeatureTrack.prototype._drawFeature=FeatureTrack.prototype._drawFeature;CytobandFeatureTrack.prototype.appendFeatures=FeatureTrack.prototype.appendFeatures;CytobandFeatureTrack.prototype._addFeatures=function(a){this.features=a.toJSON();this.featuresIndex={}};
function RegionFeatureTrack(a,c,b){FeatureTrack.prototype.constructor.call(this,a,c,b);this.forceColor=this.opacity=null;null!=b&&(null!=b.opacity&&(this.opacity=b.opacity),null!=b.forceColor&&(this.forceColor=b.forceColor));this.positions={}}RegionFeatureTrack.prototype.getIdToPrint=FeatureTrack.prototype.getIdToPrint;RegionFeatureTrack.prototype.changeView=FeatureTrack.prototype.changeView;RegionFeatureTrack.prototype.render=FeatureTrack.prototype.render;RegionFeatureTrack.prototype.init=FeatureTrack.prototype.init;
RegionFeatureTrack.prototype.createSVGDom=FeatureTrack.prototype.createSVGDom;RegionFeatureTrack.prototype._getTopText=FeatureTrack.prototype._getTopText;RegionFeatureTrack.prototype._getTopFeatures=FeatureTrack.prototype._getTopFeatures;RegionFeatureTrack.prototype._searchSpace=FeatureTrack.prototype._searchSpace;RegionFeatureTrack.prototype.drawTitle=FeatureTrack.prototype.drawTitle;RegionFeatureTrack.prototype.mouseMove=FeatureTrack.prototype.mouseMove;RegionFeatureTrack.prototype.mouseclick=FeatureTrack.prototype.mouseclick;
RegionFeatureTrack.prototype.getById=FeatureTrack.prototype.getById;RegionFeatureTrack.prototype.draw=FeatureTrack.prototype.draw;RegionFeatureTrack.prototype.getFeatureColor=FeatureTrack.prototype.getFeatureColor;RegionFeatureTrack.prototype.drawFeatures=FeatureTrack.prototype.drawFeatures;RegionFeatureTrack.prototype._overlapBlocks=FeatureTrack.prototype._overlapBlocks;RegionFeatureTrack.prototype._render=FeatureTrack.prototype._render;
RegionFeatureTrack.prototype._convertGenomePositionToPixelPosition=FeatureTrack.prototype._convertGenomePositionToPixelPosition;RegionFeatureTrack.prototype._getViewBoxCoordenates=FeatureTrack.prototype._getViewBoxCoordenates;RegionFeatureTrack.prototype._getFeatureWidth=FeatureTrack.prototype._getFeatureWidth;RegionFeatureTrack.prototype.clear=FeatureTrack.prototype.clear;RegionFeatureTrack.prototype.drawBackground=FeatureTrack.prototype.drawBackground;RegionFeatureTrack.prototype.moveTitle=FeatureTrack.prototype.moveTitle;
RegionFeatureTrack.prototype.moveY=FeatureTrack.prototype.moveY;RegionFeatureTrack.prototype.appendFeatures=function(a){this.drawFeatures(a.toJSON())};RegionFeatureTrack.prototype._addFeatures=function(a){this.features=a.toJSON();this.featuresIndex={}};
RegionFeatureTrack.prototype._updateTop=function(){var a=this.height;this.avoidOverlapping&&(a=this.featureHeight+12*this.queues.length);this.maxHeight<a&&(this.maxHeight=a);this.height=this.maxHeight;null!=this.backgroundNode&&this.backgroundNode.setAttribute("height",this.maxHeight)};
RegionFeatureTrack.prototype._setAttributes=function(a){a=[["id",this.id+"_"+a.start+"_"+a.id],["font-size",a.getDefault().args.fontSize]];a.push(["fill","red"]);a.push(["opacity","0.6"]);a.push(["stroke","black"]);a.push(["stroke-width","1"]);return a};RegionFeatureTrack.prototype._setTextAttributes=function(a){this.getFeatureColor(a);return[["fill","black"],["id",this.id+"_"+a.start],["cursor","pointer"],["font-size",a.getDefault().args.fontSize]]};
RegionFeatureTrack.prototype._drawFeature=function(a,c,b,d,e){this.positions[Math.ceil(a)]=!0;SVG.drawRectangle(Math.ceil(a),c,Math.abs(b),Math.abs(this.featureHeight),this.trackNodeGroup,d);if(this.label){var f=this;SVG.drawText(Math.ceil(a),Math.ceil(c)+2*this.featureHeight-2,e.label,this.trackNodeGroup,this._setTextAttributes(e)).addEventListener("click",function(){f.onClick.notify(e)},!0)}};HistogramFeatureTrack.prototype.getIdToPrint=FeatureTrack.prototype.getIdToPrint;
HistogramFeatureTrack.prototype.changeView=FeatureTrack.prototype.changeView;HistogramFeatureTrack.prototype.render=FeatureTrack.prototype.render;HistogramFeatureTrack.prototype.init=FeatureTrack.prototype.init;HistogramFeatureTrack.prototype.createSVGDom=FeatureTrack.prototype.createSVGDom;HistogramFeatureTrack.prototype._getTopText=FeatureTrack.prototype._getTopText;HistogramFeatureTrack.prototype._getTopFeatures=FeatureTrack.prototype._getTopFeatures;
HistogramFeatureTrack.prototype._searchSpace=FeatureTrack.prototype._searchSpace;HistogramFeatureTrack.prototype.drawTitle=FeatureTrack.prototype.drawTitle;HistogramFeatureTrack.prototype.mouseMove=FeatureTrack.prototype.mouseMove;HistogramFeatureTrack.prototype.mouseclick=FeatureTrack.prototype.mouseclick;HistogramFeatureTrack.prototype.getById=FeatureTrack.prototype.getById;HistogramFeatureTrack.prototype.draw=FeatureTrack.prototype.draw;HistogramFeatureTrack.prototype.getFeatureColor=FeatureTrack.prototype.getFeatureColor;
HistogramFeatureTrack.prototype.drawFeatures=FeatureTrack.prototype.drawFeatures;HistogramFeatureTrack.prototype._overlapBlocks=FeatureTrack.prototype._overlapBlocks;HistogramFeatureTrack.prototype._render=FeatureTrack.prototype._render;HistogramFeatureTrack.prototype._convertGenomePositionToPixelPosition=FeatureTrack.prototype._convertGenomePositionToPixelPosition;HistogramFeatureTrack.prototype._getViewBoxCoordenates=FeatureTrack.prototype._getViewBoxCoordenates;
HistogramFeatureTrack.prototype._getFeatureWidth=FeatureTrack.prototype._getFeatureWidth;HistogramFeatureTrack.prototype.clear=FeatureTrack.prototype.clear;HistogramFeatureTrack.prototype.drawBackground=FeatureTrack.prototype.drawBackground;HistogramFeatureTrack.prototype.moveTitle=FeatureTrack.prototype.moveTitle;HistogramFeatureTrack.prototype.isFeatureDuplicated=FeatureTrack.prototype.isFeatureDuplicated;HistogramFeatureTrack.prototype.drawFeaturesInQueue=FeatureTrack.prototype.drawFeaturesInQueue;
function HistogramFeatureTrack(a,c,b,d){FeatureTrack.prototype.constructor.call(this,a,c,b,d);this.forceColor=this.opacity=null;this.intervalSize=2E6;null!=d&&(null!=d.opacity&&(this.opacity=d.opacity),null!=d.forceColor&&(this.forceColor=d.forceColor),null!=d.intervalSize&&(this.intervalSize=d.intervalSize));this.positions={};this.allowDuplicates=!0}
HistogramFeatureTrack.prototype.getFeaturesInterval=function(a){var c=[],b=this.intervalSize;if(0<a.length){for(var d=a[a.length-1].end,e=a[0].start;e<d;)c.push({start:e,end:e+b,value:0}),e+=b;for(e=d=b=0;e<a.length;e++)for(var f=b;f<c.length;f++)c[f].start<a[e].end&&c[f].end>a[e].start&&(c[f].value+=1,c[f].value>d&&(d=c[f].value),b=f)}for(e=0;e<c.length;e++)c[e].value/=d;return c};HistogramFeatureTrack.prototype.appendFeatures=function(a){this.drawFeatures(a.toJSON())};
HistogramFeatureTrack.prototype.sort=function(a,c){return a.start-c.start};HistogramFeatureTrack.prototype._addFeatures=function(a){this.featuresIndex={};this.features=a.toJSON()};HistogramFeatureTrack.prototype._updateTop=function(){if(this.avoidOverlapping)for(var a=0;a<this.queues.length;a++)this.height+=this.featureHeight};
HistogramFeatureTrack.prototype._setAttributes=function(a){a=[["id",this.id+"_"+a.start+"_"+a.id]];null!=this.forceColor?a.push(["fill",this.forceColor]):a.push(["fill","red"]);return a};HistogramFeatureTrack.prototype._setTextAttributes=function(a){return[["fill","black"],["id",this.id+"_"+a.start],["cursor","pointer"]]};
HistogramFeatureTrack.prototype._drawFeature=function(a,c,b,d,e){var f=this;0>b&&(b=2);this.positions[Math.ceil(a)]=!0;SVG.drawRectangle(Math.ceil(a),c+(this.featureHeight-e.value*Math.abs(this.featureHeight)),b,e.value*Math.abs(this.featureHeight),this.trackNodeGroup,d);this.label&&SVG.drawText(Math.ceil(a)+12,Math.ceil(c)+this.featureHeight,e.label,this.labelNodeGroup,this._setTextAttributes(e)).addEventListener("click",function(){f.onClick.notify(e)},!0)};
VCFFeatureTrack.prototype.getIdToPrint=FeatureTrack.prototype.getIdToPrint;VCFFeatureTrack.prototype.changeView=FeatureTrack.prototype.changeView;VCFFeatureTrack.prototype.render=FeatureTrack.prototype.render;VCFFeatureTrack.prototype.init=FeatureTrack.prototype.init;VCFFeatureTrack.prototype.createSVGDom=FeatureTrack.prototype.createSVGDom;VCFFeatureTrack.prototype._getTopText=FeatureTrack.prototype._getTopText;VCFFeatureTrack.prototype._getTopFeatures=FeatureTrack.prototype._getTopFeatures;
VCFFeatureTrack.prototype._searchSpace=FeatureTrack.prototype._searchSpace;VCFFeatureTrack.prototype.drawTitle=FeatureTrack.prototype.drawTitle;VCFFeatureTrack.prototype.mouseMove=FeatureTrack.prototype.mouseMove;VCFFeatureTrack.prototype.mouseclick=FeatureTrack.prototype.mouseclick;VCFFeatureTrack.prototype.getById=FeatureTrack.prototype.getById;VCFFeatureTrack.prototype.draw=FeatureTrack.prototype.draw;VCFFeatureTrack.prototype.getFeatureColor=FeatureTrack.prototype.getFeatureColor;
VCFFeatureTrack.prototype.drawFeatures=FeatureTrack.prototype.drawFeatures;VCFFeatureTrack.prototype._overlapBlocks=FeatureTrack.prototype._overlapBlocks;VCFFeatureTrack.prototype._render=FeatureTrack.prototype._render;VCFFeatureTrack.prototype._convertGenomePositionToPixelPosition=FeatureTrack.prototype._convertGenomePositionToPixelPosition;VCFFeatureTrack.prototype._getViewBoxCoordenates=FeatureTrack.prototype._getViewBoxCoordenates;VCFFeatureTrack.prototype._getFeatureWidth=FeatureTrack.prototype._getFeatureWidth;
VCFFeatureTrack.prototype.clear=FeatureTrack.prototype.clear;VCFFeatureTrack.prototype.drawBackground=FeatureTrack.prototype.drawBackground;VCFFeatureTrack.prototype.moveTitle=FeatureTrack.prototype.moveTitle;VCFFeatureTrack.prototype._setAttributes=FeatureTrack.prototype._setAttributes;VCFFeatureTrack.prototype._setTextAttributes=FeatureTrack.prototype._setTextAttributes;VCFFeatureTrack.prototype._updateTop=FeatureTrack.prototype._updateTop;VCFFeatureTrack.prototype.drawFeaturesInQueue=FeatureTrack.prototype.drawFeaturesInQueue;
VCFFeatureTrack.prototype._renderLabel=FeatureTrack.prototype._renderLabel;function VCFFeatureTrack(a,c,b){FeatureTrack.prototype.constructor.call(this,a,c,b);this.positions={};this.counter=0;console.log(this.featureHeight)}VCFFeatureTrack.prototype.appendFeatures=function(a){this.drawFeatures(a.toJSON())};VCFFeatureTrack.prototype._addFeatures=function(a){this.features=a.toJSON();this.featuresIndex={}};
VCFFeatureTrack.prototype._drawFeature=function(a,c,b,d,e){1>=b&&(b=2);this.positions[Math.ceil(a)]=!0;SVG.drawRectangle(Math.ceil(a),c,b,this.featureHeight,this.trackNodeGroup,d);if(null!=e.base)for(var d=e.base.length,b=b/d,f=0;f<d;f++)SVG.drawText(f*b+a+2,Math.ceil(c)+8,e.base[f],this.labelNodeGroup,[["font-size","8"],["fill","#ffffff"]]);this.label&&this._renderLabel(Math.ceil(a),Math.ceil(c)+(this.featureHeight+this.labelHeight),e.label,this._setTextAttributes(e),e)};
ChromosomeFeatureTrack.prototype.createSVGDom=FeatureTrack.prototype.createSVGDom;ChromosomeFeatureTrack.prototype.init=FeatureTrack.prototype.init;ChromosomeFeatureTrack.prototype.draw=FeatureTrack.prototype.draw;ChromosomeFeatureTrack.prototype._render=FeatureTrack.prototype._render;ChromosomeFeatureTrack.prototype.getById=FeatureTrack.prototype.getById;ChromosomeFeatureTrack.prototype._getViewBoxCoordenates=FeatureTrack.prototype._getViewBoxCoordenates;
ChromosomeFeatureTrack.prototype._getSVGCoordenates=FeatureTrack.prototype._getSVGCoordenates;ChromosomeFeatureTrack.prototype.drawBackground=FeatureTrack.prototype.drawBackground;
function ChromosomeFeatureTrack(a,c,b,d){FeatureTrack.prototype.constructor.call(this,a,c,b,d);this.selectcolor="#33FF33";this.markcolor="#FF3333";this.radio=3;this.markers={};this.start=1;this.vertical=this.labelChromosome=!1;this.rounded=7;this.label=!1;this.maxFeatureEnd=1;null!=d&&(null!=d.label&&(this.label=d.label),null!=d.labelChromosome&&(this.labelChromosome=d.labelChromosome),null!=d.vertical&&(this.vertical=d.vertical),null!=d.rounded&&(this.rounded=d.rounded),null!=d.bottom&&(this.bottom=
d.bottom));this.onMarkerClicked=new Event(this);this.selector={};this.selector.selectorIsMoving=!1;this.selector.selectorSVG=null;this.selector.selectorBorder=null;this.selector.start=null;this.selector.end=null;this.selector.mouseOffsetX=null}ChromosomeFeatureTrack.prototype.getCentromeros=function(){for(var a=[],c=0;c<this.features.length;c++)"acen"==this.features[c].stain&&a.push(this.features[c]);return a};
ChromosomeFeatureTrack.prototype.getEnd=function(a){for(var c=0,b=0;b<a.length;b++)a[b].end>c&&(c=a[b].end);return c};ChromosomeFeatureTrack.prototype.getColorByStain=function(a){if("gneg"==a.stain)return"white";if("stalk"==a.stain)return"#666666";if("gvar"==a.stain)return"#CCCCCC";if(-1!=a.stain.indexOf("gpos")){var c=a.stain.replace("gpos","");if(25==c)return"silver";if(50==c)return"gray";if(75==c)return"darkgray";if(100==c)return"black"}return"acen"==a.stain?"blue":"purple"};
ChromosomeFeatureTrack.prototype.getPixelScale=function(){return this.vertical?(this.bottom-this.top)/(this.end-this.start):(this.right-this.left)/(this.end-this.start)};ChromosomeFeatureTrack.prototype.setBackgroundColor=function(a){this.backgroundSVGNode.setAttribute("fill",a);"white"==a?this.backgroundSVGNode.setAttribute("stroke","white"):this.backgroundSVGNode.setAttribute("stroke","black")};
ChromosomeFeatureTrack.prototype.unmark=function(){for(var a in this.markers)this.trackNodeGroup.removeChild(DOM.select(a));this.markers={}};ChromosomeFeatureTrack.prototype.getMarkIDFromFeature=function(a){var c=a.chromosome+"_"+a.start+"_"+a.end;this.markers[c]=a;return c};
ChromosomeFeatureTrack.prototype.mark=function(a,c){var b=this,d=this.getPixelScale(),e=a.start,f=a.end,g=(f-e)*d;e==f&&(g=1);null!=c&&(this.markcolor=c);if(this.vertical){var g=this.top+e*d,d=[["stroke","black"],["stroke-width","1"],["id",this.getMarkIDFromFeature(a)],["fill",this.markcolor],["opacity","1"],["cursor","pointer"]],h=SVG.drawPoligon([[this.right+6,g-3],[this.right,g],[this.right+6,g+3]],this.trackNodeGroup,d);h.addEventListener("click",function(){b.onMarkerClicked.notify(b.markers[h.id])},
!0)}else e=this.left+e*d,d=[["id",this.markers.length],["fill",this.markcolor],["opacity","1"]],SVG.drawRectangle(e,this.top,g,this.bottom-this.top+this.radio+5,this.trackNodeGroup,d),d=[["id",id],["fill",this.markcolor],["opacity","1"],["stroke","black"]],SVG.drawCircle(e,this.bottom+this.radio+5,this.radio,this.trackNodeGroup,d)};ChromosomeFeatureTrack.prototype.getSelectorId=function(){return this.id+"_selector"};
ChromosomeFeatureTrack.prototype.deselect=function(){var a=this.getSelectorId();null!=DOM.select(a)&&this.trackNodeGroup.removeChild(this.selector.selectorSVG)};
ChromosomeFeatureTrack.prototype.mouseMove=function(a){if(this.selector.selectorIsMoving&&null!=this.selector.selectorSVG){var c=this.getSVGCoordenates(a).x-this.selector.mouseOffsetX,b=this.getPixelScale(),c=parseFloat(this.selector.start)+parseFloat(Math.ceil(c/b));this.select(c,c+(this.selector.end-this.selector.start));this.selector.mouseOffsetX=this.getSVGCoordenates(a).x}};ChromosomeFeatureTrack.prototype.mouseDown=function(a){this.selector.selectorIsMoving=!0;this.selector.mouseOffsetX=this.getSVGCoordenates(a).x};
ChromosomeFeatureTrack.prototype.mouseUp=function(){this.selector.selectorIsMoving=!1;this.click.notify(this.selector.start+(this.selector.end-this.selector.start)/2)};
ChromosomeFeatureTrack.prototype.select=function(a,c){var b=this;this.selector.id=this.getSelectorId();this.selector.start=a;this.selector.end=c;c>this.maxFeatureEnd&&0<(this.maxFeatureEnd-a)*d&&(c=this.maxFeatureEnd);this.deselect();if(null!=this.trackNodeGroup){var d=this.getPixelScale();if(this.vertical){var d=this.getPixelScale(),e=Math.ceil(this.top+d*a),d=[["stroke","black"],["stroke-width","1"],["id",this.selector.id],["cursor","move"],["fill",this.selectcolor],["opacity","1"]];this.selector.selectorSVG=
SVG.drawPoligon([[0,e-5],[this.left,e],[0,e+5]],this.trackNodeGroup,d)}else{var e=this.left+a*d,f=Math.ceil((c-a)*d),d=[["stroke","red"],["stroke-width","1"],["id",this.selector.id],["cursor","move"],["fill",this.selectcolor],["fill-opacity","0.1"]];this.selector.selectorSVG=SVG.drawRectangle(e,this.top+6,f,this.bottom-this.top,this.trackNodeGroup,d);this.selector.selectorSVG.addEventListener("mousemove",function(a){b.mouseMove(a,b)},!1);this.selector.selectorSVG.addEventListener("mousedown",function(a){b.mouseDown(a,
b)},!1);this.selector.selectorSVG.addEventListener("mouseup",function(a){b.mouseUp(a,b)},!1)}}};
ChromosomeFeatureTrack.prototype.drawFeatures=function(){var a=this.getCentromeros();this.pixelInc=this.getPixelScale();var c=0;0!=a.length?(c=a[0].end*this.pixelInc,this.centromerosVisited=!1):this.centromerosVisited=!0;a=[["stroke","black"],["stroke-width","1"],["id","clip"],["fill","pink"],["rx",this.rounded],["ry",this.rounded],["z-index","0"]];if(this.vertical){this.featureHeight=this.right-this.left-1;var b=c+this.top,d=this.bottom-c-this.top,e=SVG.createRectangle(this.left,b,this.featureHeight,
d,a);this.trackNodeGroup.appendChild(e);e=SVG.createRectangle(this.left,b,this.featureHeight,d,a);this.trackNodeGroup.appendChild(e);SVG.drawClip("clip_1"+this.id,e,this.trackNodeGroup);this.groupNodeFirstCentromero=SVG.drawGroup(this.trackNodeGroup,[["id","clip_group"],["clip-path","url(#clip_1"+this.id+")"]]);b=this.top;d=c;e=SVG.createRectangle(this.left,b+1,this.featureHeight,d,a);this.trackNodeGroup.appendChild(e);e=SVG.createRectangle(this.left,b+1,this.featureHeight,d,a)}else this.featureHeight=
Math.ceil(this.bottom-this.top),e=SVG.createRectangle(this.left,this.top+6,c,this.featureHeight,a),this.trackNodeGroup.appendChild(e),e=SVG.createRectangle(this.left,this.top+6,c,this.featureHeight,a),this.trackNodeGroup.appendChild(e),SVG.drawClip("clip_1"+this.id,e,this.trackNodeGroup),this.groupNodeFirstCentromero=SVG.drawGroup(this.trackNodeGroup,[["id","clip_group"],["clip-path","url(#clip_1"+this.id+")"]]),b=Math.ceil(c+this.left),c=Math.ceil(this.right-c-this.left-2),e=SVG.createRectangle(b,
this.top+6,c,this.featureHeight,a),this.trackNodeGroup.appendChild(e),e=SVG.createRectangle(b,this.top+6,c,this.featureHeight,a);this.trackNodeGroup.appendChild(e);SVG.drawClip("clip_2"+this.id,e,this.trackNodeGroup);groupNodeSecondCentromero=SVG.drawGroup(this.trackNodeGroup,[["id","clip_group"],["clip-path","url(#clip_2"+this.id+")"]]);for(c=0;c<this.features.length;c++)a=this.features[c],this._drawCytoband(a),0==c&&this.label&&(e=[["id",this.id_+"title"],["font-size","9"]],this.vertical&&SVG.drawText(this.left,
this.height,a.chromosome,this.labelNodeGroup,e))};
ChromosomeFeatureTrack.prototype._drawCytoband=function(a){var c=this,b=stroke=this.getColorByStain(a),d=null,d=this.pixelInc*(a.end-a.start),b=[["fill",b],["id",this.id+"_"+a.cytoband],["z-index","10"],["stroke",stroke],["style","cursor:pointer"]];this.maxFeatureEnd<a.end&&(this.maxFeatureEnd=a.end);this.vertical?(d=SVG.createRectangle(Math.ceil(this.left),Math.ceil(this.top+this.pixelInc*(a.start-this.start)),Math.ceil(this.right-this.left),Math.ceil(d),b),this.centromerosVisited?this.groupNodeFirstCentromero.appendChild(d):
groupNodeSecondCentromero.appendChild(d)):(d=SVG.createRectangle(Math.ceil(this.left+this.pixelInc*(a.start-this.start)),this.top,d,Math.ceil(this.featureHeight)+6,b),this.centromerosVisited?groupNodeSecondCentromero.appendChild(d):this.groupNodeFirstCentromero.appendChild(d),this.label&&(b=[["fill","black"],["id",this.id_+"title"],["opacity","1"],["font-size","7"]],b.push(["transform","translate("+(this.left+this.pixelInc*(a.start+(a.end-a.start)/2-this.start))+", "+(this.height+10)+"), rotate(270)"]),
SVG.drawText(0,0,a.cytoband,this.labelNodeGroup,b)));d.addEventListener("click",function(b){c.vertical?c.click.notify(a):(b=c._getSVGCoordenates(b),b=Math.ceil((b.x-c.left)/c.pixelInc),c.click.notify(b))},!0);"acen"==a.stain&&(this.centromerosVisited=!0)};ChromosomeFeatureTrack.prototype.draw=function(a){this.features=a.toJSON()[0];this.featuresIndex={};this.printedFeature={};if(null!=this.features){for(a=0;a<this.features.length;a++)this.featuresIndex[this.features[a].id]=a;this.end=this.getEnd(this.features)}this._render()};
ChromosomeFeatureTrack.prototype.getSVGCoordenates=function(a){var c=this._svg.createSVGPoint();c.x=a.clientX;c.y=a.clientY;a=this._svg.getScreenCTM(document.documentElement);return c=c.matrixTransform(a.inverse())};
