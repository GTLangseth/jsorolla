<polymer-element name="jso-pathivar-form" attributes="studies">
    <template>
        <link rel="stylesheet" href="../jso-style.css">
        <link rel="stylesheet" href="../jso-panel.css">
        <style>
            :host {
                display: block;
                position: absolute;
                box-sizing: border-box;
                background-color: #FFFFFF;
                padding: 30px 100px;

                z-index: 50000;
                top: 90px;

                left: 0;
                right: 0;
                margin-left: auto;
                margin-right: auto;

                width: 50%;
                border: 1px solid #c6d0da;
                /*border-top-width: 1px;*/
                transition: all 0.2s;
                box-shadow: 10px 10px 10px rgba(0, 0, 0, 0.2);
            }

            .title {
                text-align: center;
                font-size: 25px;
                color: #666;
            }

            .icon {
                color: #445D76;
                font-size: 50px;
            }

            label {
                display: inline-block;
                color: #666;
                margin-top: 10px;
            }

            label::after {
                content: ':'
            }

            .message {
                margin-top: 20px;
            }

            .check-panel {
                margin-top: 5px;
                margin-right: 5px;
            }

            .check-list {
                box-sizing: border-box;
                overflow-y: auto;
                height: 300px;
                /*padding-left: 5px;*/
                padding: 5px;
            }

            .check-name {
                line-height: 25px;
                margin-left: 10px;
            }

            .checkbox {
                width: 25px;
                border: 1px solid gray;
                margin: 1px;
            }

            .checkbox::after {
                font-family: 'FontAwesome';
                content: ' \00a0'
            }

            .checkbox[data-checked]::after {
                content: '\f00c'
            }

            .lbl {
                line-height: 25px;
            }

            .botbar {
                margin-top: 10px;
            }

            jso-project-browser {
                height: 400px;
                border: 1px solid #d3d3d3;
                border-top-width: 0px;
                margin-top: 10px;
            }

            .message {
                color: #8b0000;
            }
        </style>
        <form id="form" on-keypress="{{handleFormKey}}">
            <div class="title">
                <div>
                    <font-awesome icon="rocket" class="icon"></font-awesome>
                    &nbsp; PATHiVAR form
                </div>
                <div class="icon">
                    <!--<font-awesome icon="rocket" animation="spin"></font-awesome>-->
                </div>
            </div>
            <br>


            <label>VCF file</label>
            <span class="message">{{vcfFileMessage}}</span>

            <div class="button action" style="width:150px;" on-click="{{handleSelectFile}}">Select VCF file...</div>
            <div style="margin-top:5px;">{{selectedStudy.name}}/{{vcfFile.path}}</div>
            <template if="{{ showBrowser }}">
                <jso-project-browser
                        on-file-select="{{handleBrowseSelect}}"
                        studies="{{studies}}"
                        selectedStudy="{{selectedStudy}}"
                        >
                </jso-project-browser>
                <div horizontal layout end-justified
                     style="padding:4px; background-color: #fafafa; border:1px solid #d3d3d3; border-top-width: 0;">
                    <div class="button action" style="width:150px;margin-right:5px;"
                         on-click="{{handleSelectFileCancel}}">
                        Cancel
                    </div>
                    <div class="button action" style="width:150px;"
                         on-click="{{handleSelectFileOk}}">
                        OK
                    </div>
                </div>
            </template>

            <br>

            <!--<label>Outdir</label>-->
            <!--{{outdir}}-->

            <!--<div>annotvcf</div>-->


            <div>
                <label>Sample name from VCF</label>
                <span class="message">{{samplecolMessage}}</span>
                <select flex value="{{samplecol}}" required>
                    <template repeat="{{sampleName in sampleNames}}">
                        <option value="{{sampleName}}">{{sampleName}}</option>
                    </template>
                </select>
            </div>
            <br>


            <div horizontal layout>
                <div>
                    <label>Type of model</label>
                    <span class="message">{{modelMessage}}</span>
                    <select flex value="{{model}}" required>
                        <option value="recessive">Recessive</option>
                        <option value="dominant">Dominant</option>
                    </select>

                </div>

                <div hidden?="{{model == 'dominant'}}" style="margin-left:20px;">
                    <label>Should compound homocygotes be included?</label>
                    <span class="message">{{comhomMessage}}</span>
                    <select flex value="{{comhom}}">
                        <option value="Y">Yes</option>
                        <option value="N">No</option>
                    </select>
                </div>
            </div>


            <label>Method for including scores</label>
            <span class="message">{{methodScoreMessage}}</span>

            <div horizontal layout style="line-height: 25px;">
                <div class="button action checkbox" data-checked?="{{ siftSelected }}"
                     on-click="{{handleSiftSelect}}"></div>
                <div class="check-name" style="width:100px;">SIFT</div>

                <div horizontal layout style="margin-left:10px;"
                     hidden?="{{ !siftSelected }}">
                    <div class="lbl">treshold: &nbsp;</div>
                    <input type="number" step="0.01" max="1" min="0" value="{{tresholdSift}}"
                           required?="{{ siftSelected }}">

                    <div style="color:#666">&nbsp; Less than 0.05 means DAMAGE, higher than 0.05 means TOLERANT</div>
                </div>
            </div>

            <div horizontal layout style="line-height: 25px;">
                <div class="button action checkbox" data-checked?="{{ polyphenSelected }}"
                     on-click="{{handlePolyphenSelect}}"></div>
                <div class="check-name" style="width:100px;">PolyPhen</div>


                <div horizontal layout style="margin-left:10px;"
                     hidden?="{{ !polyphenSelected}}">
                    <div class="lbl">treshold: &nbsp;</div>
                    <input type="number" step="0.01" max="1" min="0" value="{{tresholdPolyphen}}"
                           required?="{{ polyphenSelected }}">

                    <div style="color:#666">&nbsp; Higher values means more DAMAGE</div>
                </div>
            </div>

            <div horizontal layout style="line-height: 25px;">
                <div class="button action checkbox" data-checked?="{{ consSelected }}"
                     on-click="{{handleConsSelect}}"></div>
                <div class="check-name" style="width:100px;">PhastCons</div>

                <template if="{{consSelected}}">
                    <div horizontal layout style="margin-left:10px;">
                        <div class="lbl">treshold: &nbsp;</div>
                        <input type="number" max="1000" min="0" value="{{tresholdCons}}" required>

                        <div style="color:#666">&nbsp; Higher values means more CONSERVATION</div>
                    </div>
                </template>

            </div>

            <br>

            <div flex class="panel check-panel" vertical layout>
                <div class="header" horizontal layout>
                    <div class="text">Pathways</div>
                    <div class="headeractions" horizontal end-justified layout flex>
                        <div class="text" on-click="{{handleSelectAllPw}}">Select all</div>
                        <div class="text" on-click="{{handleDeselectAllPw}}">Deselect all</div>
                    </div>
                </div>
                <div class="check-list">
                    <template repeat="{{item in pathwaysSet}}">
                        <div horizontal layout>
                            <div class="button action checkbox" data-checked?="{{ item.selected }}"
                                 on-click="{{handleItemSelect}}"></div>
                            <div class="check-name">{{item.name}}</div>
                        </div>
                    </template>
                </div>
            </div>
            <div horizontal layout>
                <div flex class="panel check-panel" vertical layout>
                    <div class="header" horizontal layout>
                        <div class="text">Consequence types</div>
                        <div class="headeractions" horizontal end-justified layout flex>
                            <div class="text" on-click="{{handleSelectAllCt}}">Select all</div>
                            <div class="text" on-click="{{handleDeselectAllCt}}">Deselect all</div>
                        </div>
                    </div>
                    <div class="check-list">
                        <template repeat="{{item in consequenceTypes}}">
                            <div horizontal layout>
                                <div class="button action checkbox" data-checked?="{{ item.selected }}"
                                     on-click="{{handleItemSelect}}"></div>
                                <div class="check-name">{{item.name}}</div>
                            </div>
                        </template>
                    </div>
                </div>

                <div flex class="panel check-panel" vertical layout>
                    <div class="header" horizontal layout>
                        <div class="text">Tissues</div>
                        <div class="headeractions" horizontal end-justified layout flex>
                            <div class="text" data-checked?="{{tissues == humanProteinAtlasTissues}}"
                                 on-click="{{handleHumanProteinTissues}}">Human protein atlas
                            </div>
                            <div class="text" data-checked?="{{tissues == expressionAtlasTissues}}"
                                 on-click="{{handleExpressionTissues}}">Expression atlas
                            </div>
                        </div>
                    </div>
                    <div class="check-list">
                        <template repeat="{{item in tissues}}">
                            <div horizontal layout>
                                <div class="button action checkbox" data-checked?="{{ item.selected }}"
                                     on-click="{{handleTissueItemSelect}}"></div>
                                <div class="check-name">{{item.name}}</div>
                            </div>
                        </template>
                    </div>
                </div>


            </div>


            <div class="botbar" horizontal layout end-justified>
                <div class="button action" style="width: 150px;" on-click="{{launchJob}}">
                    <font-awesome icon="rocket"></font-awesome>
                    &nbsp; Launch job
                </div>
                <!--<div class="button action" style="width: 100px;" on-click="{{handleGetFolderIdToTest}}">-->
            </div>
            </div>
        </form>
        <div class="message">{{message}}</div>
        <div class="message">{{folderId}}</div>
    </template>

    <script>
        Polymer({
            created: function () {
                this._initVariables();

                this.selectedStudy;

                this.toolName = "pathiways";
                this.execution = "pathivar";

                this.analysisId = 1;
                this.outdirId = 1222;

                this.jobName = 'jobName';
                this.description = 'Description';


                this.tresholdSift = 0.05;
                this.tresholdPolyphen = 0.85;
                this.tresholdCons = 300;

                this.siftSelected = true;
                this.polyphenSelected = true;
                this.consSelected = false;

                this.model = "recessive";
                this.comhom = "Y";

                this.sampleNames = [];

                this.tissues = this.humanProteinAtlasTissues;
            },
            sampleNamesChanged: function (oldValue, newValue) {
                this.samplecol = this.sampleNames[0];
            },
            handleSiftSelect: function (e) {
                this.siftSelected = !this.siftSelected;
            },
            handlePolyphenSelect: function (e) {
                this.polyphenSelected = !this.polyphenSelected;
            },
            handleConsSelect: function (e) {
                this.consSelected = !this.consSelected;
            },
            handleSelectFile: function (e) {
                this.showBrowser = true;
            },
            handleSelectFileOk: function (e) {
                if (this.checkVcfFile()) {
                    this.showBrowser = false;
                    this.getSamplesFromVcf();
                }
            },
            handleSelectFileCancel: function (e) {
                this.showBrowser = false;
                this.vcfFile = null;
            },
            checkVcfFile: function () {
                var bool = this.vcfFile != null && Utils.endsWith(this.vcfFile.name, ".vcf");
                if (bool) {
                    this.vcfFileMessage = '';
                } else {
                    this.vcfFileMessage = 'This file is not VCF';
                }
                return bool;
            },
            handleBrowseSelect: function (e) {
                var file = e.detail.file;
                this.vcfFile = file;
                this.checkVcfFile();
            },
            handleItemSelect: function (e) {
                var item = e.target.templateInstance.model.item;
                item.selected = !item.selected;
            },
            handleTissueItemSelect: function (e) {
                for (var i = 0; i < this.humanProteinAtlasTissues.length; i++) {
                    var t = this.humanProteinAtlasTissues[i];
                    t.selected = false;
                }
                for (var i = 0; i < this.expressionAtlasTissues.length; i++) {
                    var t = this.expressionAtlasTissues[i];
                    t.selected = false;
                }
                var item = e.target.templateInstance.model.item;
                item.selected = !item.selected;
            },
            handleSelectAllPw: function () {
                for (var i = 0; i < this.pathwaysSet.length; i++) {
                    var pw = this.pathwaysSet[i];
                    pw.selected = true;
                }
            },
            handleDeselectAllPw: function () {
                for (var i = 0; i < this.pathwaysSet.length; i++) {
                    var pw = this.pathwaysSet[i];
                    pw.selected = false;
                }
            },
            handleSelectAllCt: function () {
                for (var i = 0; i < this.consequenceTypes.length; i++) {
                    var ct = this.consequenceTypes[i];
                    ct.selected = true;
                }
            },
            handleDeselectAllCt: function () {
                for (var i = 0; i < this.consequenceTypes.length; i++) {
                    var ct = this.consequenceTypes[i];
                    ct.selected = false;
                }
            },
            handleHumanProteinTissues: function () {
                this.tissues = this.humanProteinAtlasTissues;
            },
            handleExpressionTissues: function () {
                this.tissues = this.expressionAtlasTissues;
            },
            handleFormKey: function (e) {
                if (e.which == 13) {
                    this.handleForm();
                }
            },
            getSamplesFromVcf: function () {
                var me = this;
                OpencgaManager.files.contentGrep({
                    id: this.vcfFile.id,
                    query: {
                        sid: Cookies('bioinfo_sid'),
                        ignoreCase: true,
                        multi: false,
                        pattern: encodeURIComponent('^#CHR.*')
                    },
                    request: {
                        async: false,
                        success: function (response) {
                            me.sampleNames = response.trim().split("\t").slice(9);
                        },
                        error: function () {
                            console.log('Server error, try again later.');
                        }
                    }
                });


            },
            generateRandomFolder: function () {
                var folder;
                OpencgaManager.files.createFolder({
                    query: {
                        sid: Cookies('bioinfo_sid'),
                        folder: "pathivar-" + Utils.randomString(20),
                        studyId: this.selectedStudy.id
                    },
                    request: {
                        async: false,
                        success: function (response) {
                            console.log(response)
                            if (response.response[0].errorMsg === '' || response.response[0].errorMsg == null) {
                                folder = response.response[0].result[0];
                            } else {
                                console.log(response.response[0].errorMsg);
                            }
                        },
                        error: function () {
                            console.log('Server error, try again later');
                        }
                    }
                });
                return folder;
            },
            launchJob: function () {
                var me = this;


//                this.vcfFile = "";
//                this.annotvcf = "/tmp/pv/annotvcf.vpa";
//                this.ctypes = "splice_acceptor_variant,splice_donor_variant,stop_gained,stop_lost,non_synonymous_codon,exon_variant"
//                this.samplecol = "muestra_A";
//                this.pathways = "hsa04012,hsa04020,hsa04080,hsa04210"
//                this.tissue = "lung"
//                this.model = "recessive"
//                this.comhom = "Y"
//                this.methodscore = "siftpolyphen"
//                this.treshold = "0.05:0.85:NA"


//                "outputParam": "outdir",
//                        "validParams": [
//                    {"name":"annotvcf", "description":"", "required":"false"},
//                    {"name":"vcfFile", "description":"", "required":"false"},
//
//                    {"name":"ctypes", "description":"", "required":"true"},
//                    {"name":"samplecol", "description":"", "required":"true"},
//                    {"name":"pathways", "description":"", "required":"true"},
//                    {"name":"tissue", "description":"", "required":"true"},
//                    {"name":"model", "description":"", "required":"true"},
//                    {"name":"comhom", "description":"", "required":"true"},
//                    {"name":"methodscore", "description":"", "required":"true"},
//                    {"name":"treshold", "description":"", "required":"true"},


//                this.consequenceTypes
//                this.humanProteinAtlasTissues
//                this.expressionAtlasTissues


                this.pathways = [];
                for (var i = 0; i < this.pathwaysSet.length; i++) {
                    var pathway = this.pathwaysSet[i];
                    if (pathway.selected) {
                        this.pathways.push('hsa' + pathway.value);
                    }
                }
                this.ctypes = [];
                for (var i = 0; i < this.consequenceTypes.length; i++) {
                    var ct = this.consequenceTypes[i];
                    if (ct.selected) {
                        this.ctypes.push(ct.name);
                    }
                }

                var tissues = [];
                for (var i = 0; i < this.humanProteinAtlasTissues.length; i++) {
                    var t = this.humanProteinAtlasTissues[i];
                    if (t.selected) {
                        tissues.push(t.name);
                    }
                }
                for (var i = 0; i < this.expressionAtlasTissues.length; i++) {
                    var t = this.expressionAtlasTissues[i];
                    if (t.selected) {
                        tissues.push(t.name);
                    }
                }
                this.tissue = tissues[0];

                this.methodscore = '';
                this.treshold = '';
                if (this.siftSelected) {
                    this.methodscore += 'sift';
                    this.treshold += this.tresholdSift;
                }
                if (this.polyphenSelected) {
                    this.methodscore += 'polyphen';
                    this.treshold += ':' + this.tresholdPolyphen
                }
                if (this.consSelected) {
                    this.methodscore += 'cons';
                    this.treshold += ':' + this.tresholdCons
                }

                this.tissueSet;
                if (this.tissues == this.humanProteinAtlasTissues) {
                    this.tissueSet = 'hpa';
                }
                if (this.tissues == this.expressionAtlasTissues) {
                    this.tissueSet = 'ea';
                }

                console.log(this.$.form.checkValidity())

                if (this.$.form.checkValidity() &&
                        this.checkVcfFile() &&
                        this.samplecol != null &&
                        this.model != null &&
                        this.pathways.length > 0 &&
                        this.ctypes.length > 0 &&
                        this.tissue &&
                        this.methodscore != '' &&
                        this.treshold != '' &&
                        this.tissueSet != null
                ) {
                    var outputFolder = this.generateRandomFolder();

                    var comhom;
                    if (this.model == 'recessive') {
                        comhom = this.comhom;
                    }


                    OpencgaManager.jobs.create({
                        query: {
                            sid: Cookies("bioinfo_sid"),
                            execution: this.execution,
                            studyId: this.selectedStudy.id,
                            toolId: this.toolName,
                            name: this.jobName,
                            description: this.description,
                            outdir: outputFolder.id,

                            //                        annotvcf: this.annotvcf,
                            vcfFile: this.vcfFile.id,
                            ctypes: this.ctypes,
                            samplecol: this.samplecol,
                            pathways: this.pathways,
                            tissue: this.tissue,
                            model: this.model,
                            comhom: comhom,
                            methodscore: this.methodscore,
                            treshold: this.treshold,
                            tissueSet: this.tissueSet
                        },
                        request: {
                            //method: 'POST',
                            success: function (response) {
                                if (response.response[0].errorMsg === '' || response.response[0].errorMsg == null) {
                                    var jobId = response.response[0].result[0].id;
//                                    me.message = jobId + ' created';
                                    me.selectedOption = "jobLaunched"
                                } else {
                                    me.message = response.response[0].errorMsg;
                                }
                            },
                            error: function () {
                                me.message = 'Server error, try again later.';
                            }
                        }
                    });

                }

            },
            _initVariables: function () {
                this.pathwaysSet = [
                    {name: 'PPAR SIGNALING PATHWAY', selected: false, value: '03320'},
                    {name: 'ERBB SIGNALING PATHWAY', selected: false, value: '04012'},
                    {name: 'CALCIUM SIGNALING PATHWAY', selected: false, value: '04020'},
                    {
                        name: 'CYTOKINE-CYTOKINE RECEPTOR',
                        selected: false,
                        value: '04060',
                        id: 'pathways04060' + this.id
                    },
//            { name: 'CHEMOKINE SIGNALING PATHWAY', selected: false, value: '04062', id: 'pathways04062' + this.id},
                    {name: 'NEUROACTIVE LIGAND-RECEPTOR INTERACTION', selected: false, value: '04080'},
                    {name: 'p53 SIGNALING PATHWAY', selected: false, value: '04115', id: 'pathways04115' + this.id},
                    {name: 'mTOR SIGNALING PATHWAY', selected: false, value: '04150', id: 'pathways04150' + this.id},
                    {name: 'APOPTOSIS', selected: false, value: '04210'},
                    {name: 'WNT SIGNALING PATHWAY', selected: false, value: '04310'},
                    {name: 'NOTCH SIGNALING PATHWAY', selected: false, value: '04330'},
                    {
                        name: 'HEDGEHOG SIGNALING PATHWAY',
                        selected: false,
                        value: '04340',
                        id: 'pathways04340' + this.id
                    },
                    {name: 'VEGF SIGNALING PATHWAY', selected: false, value: '04370'},
                    {name: 'ECM-RECEPTOR INTERACTION', selected: false, value: '04512', id: 'pathways04512' + this.id},
                    {name: 'CELL ADHESION MOLECULES', selected: false, value: '04514'},
                    {name: 'TIGH JUNCTION', selected: false, value: '04530', id: 'pathways04530' + this.id},
                    {name: 'GAP JUNCTION', selected: false, value: '04540'},
                    {name: 'ANTIGEN PROCESING AND PRESENTATION', selected: false, value: '04612'},
                    {
                        name: 'TOLL-LIKE RECEPTOR SIGNALING PATHWAY',
                        selected: false,
                        value: '04620',
                        id: 'pathways04620' + this.id
                    },
                    {name: 'JAK-STAT SIGNALING PATHWAY', selected: false, value: '04630'},
                    {
                        name: 'T CELL RECPTOR SIGNALING PATHWAY',
                        selected: false,
                        value: '04660',
                        id: 'pathways04660' + this.id
                    },
                    {name: 'B CELL RECEPTOR SIGNALING PATHWAY', selected: false, value: '04662'},
                    {name: 'Fc EPSILON RI SIGNALING PATHWAY', selected: false, value: '04664'},
                    {name: 'INSULIN SIGNALING PATHWAY', selected: false, value: '04910'},
                    {name: 'GnRH SIGNALING PATHWAY', selected: false, value: '04912'},
                    {name: 'MELANOGENESIS', selected: false, value: '04916'},
                    {name: 'ADIPOCYTOKINE SIGNALING PATHWAY', selected: false, value: '04920'}
                ];
                this.consequenceTypes = [
                    {name: "splice_acceptor_variant", selected: false},
                    {name: "splice_donor_variant", selected: false},
                    {name: "stop_gained", selected: false},
                    {name: "stop_lost", selected: false},
                    {name: "non_synonymous_codon", selected: false},
                    {name: "splice_region_variant", selected: false},
                    {name: "synonymous_codon", selected: false},
                    {name: "exon_variant", selected: false},
                    {name: "coding_sequence_variant", selected: false},
                    {name: "5_prime_UTR_variant", selected: false},
                    {name: "3_prime_UTR_variant", selected: false},
                    {name: "intron_variant", selected: false},
                    {name: "NMD_transcript_variant", selected: false},
                    {name: "nc_transcript_variant", selected: false},
                    {name: "5KB_upstream_variant", selected: false},
                    {name: "5KB_downstream_variant", selected: false},
                    {name: "TF_binding_site_variant", selected: false},
                    {name: "regulatory_region_variant", selected: false},
                    {name: "DNAseI_hypersensitive_site", selected: false},
                    {name: "RNA_polymerase_promoter", selected: false},
                    {name: "miRNA_target_site", selected: false},
                    {name: "miRNA", selected: false},
                    {name: "lincRNA", selected: false},
                    {name: "pseudogene", selected: false},
                    {name: "SNPe", selected: false},
                    {name: "intergenic_variant", selected: false}
                ];

                this.humanProteinAtlasTissues = [
                    {name: "adrenal gland", selected: false},
                    {name: "appendix", selected: false},
                    {name: "bone marrow", selected: false},
                    {name: "breast", selected: false},
                    {name: "bronchus", selected: false},
                    {name: "cerebellum", selected: false},
                    {name: "cerebral cortex", selected: false},
                    {name: "cervix, uterine", selected: false},
                    {name: "colon", selected: false},
                    {name: "duodenum", selected: false},
                    {name: "endometrium 1", selected: false},
                    {name: "endometrium 2", selected: false},
                    {name: "epididymis", selected: false},
                    {name: "esophagus", selected: false},
                    {name: "fallopian tube", selected: false},
                    {name: "gallbladder", selected: false},
                    {name: "heart muscle", selected: false},
                    {name: "hippocampus", selected: false},
                    {name: "kidney", selected: false},
                    {name: "lateral ventricle", selected: false},
                    {name: "liver", selected: false},
                    {name: "lung", selected: false},
                    {name: "lymph node", selected: false},
                    {name: "nasopharynx", selected: false},
                    {name: "oral mucosa", selected: false},
                    {name: "ovary", selected: false},
                    {name: "pancreas", selected: false},
                    {name: "parathyroid gland", selected: false},
                    {name: "placenta", selected: false},
                    {name: "prostate", selected: false},
                    {name: "rectum", selected: false},
                    {name: "salivary gland", selected: false},
                    {name: "seminal vesicle", selected: false},
                    {name: "skeletal muscle", selected: false},
                    {name: "skin 1", selected: false},
                    {name: "skin 2", selected: false},
                    {name: "small intestine", selected: false},
                    {name: "smooth muscle", selected: false},
                    {name: "soft tissue 1", selected: false},
                    {name: "soft tissue 2", selected: false},
                    {name: "spleen", selected: false},
                    {name: "stomach 1", selected: false},
                    {name: "stomach 2", selected: false},
                    {name: "testis", selected: false},
                    {name: "thyroid gland", selected: false},
                    {name: "tonsil", selected: false},
                    {name: "urinary bladder", selected: false},
                    {name: "vagina", selected: false}
                ];

                this.expressionAtlasTissues = [
                    {name: "adipose tissue normal", selected: false},
                    {name: "adipose-derived adult stem cells", selected: false},
                    {name: "amygdala", selected: false},
                    {name: "B cell", selected: false},
                    {name: "bladder", selected: false},
                    {name: "bladder mucosa", selected: false},
                    {name: "blood", selected: false},
                    {name: "bone", selected: false},
                    {name: "brain", selected: false},
                    {name: "bronchial epithelia", selected: false},
                    {name: "bronchoalveolar lavage cell", selected: false},
                    {name: "caudate nucleus", selected: false},
                    {name: "CD138+ plasma cell", selected: false},
                    {name: "CD33+ cells", selected: false},
                    {name: "CD34+ blood cell", selected: false},
                    {name: "CD34+ blood cell thymus", selected: false},
                    {name: "cerebellum", selected: false},
                    {name: "conjunctiva", selected: false},
                    {name: "connective tissue fibroblast", selected: false},
                    {name: "dendritic cell", selected: false},
                    {name: "embryonic lung fibroblast", selected: false},
                    {name: "endothelial cell", selected: false},
                    {name: "epidermis", selected: false},
                    {name: "erythrocyte", selected: false},
                    {name: "esophagus epithelium", selected: false},
                    {name: "fetal lung", selected: false},
                    {name: "frontal cortex", selected: false},
                    {name: "granulocyte", selected: false},
                    {name: "heart", selected: false},
                    {name: "hematopoietic stem cell", selected: false},
                    {name: "hippocampus CA1", selected: false},
                    {name: "hypopharynx", selected: false},
                    {name: "hypothalamus", selected: false},
                    {name: "keratinocyte", selected: false},
                    {name: "kidney", selected: false},
                    {name: "kidney epithelium", selected: false},
                    {name: "leukocyte", selected: false},
                    {name: "liver", selected: false},
                    {name: "lung", selected: false},
                    {name: "lymph node", selected: false},
                    {name: "lymphocyte", selected: false},
                    {name: "macrophage", selected: false},
                    {name: "mesangial cell", selected: false},
                    {name: "mesenchymal stem cell", selected: false},
                    {name: "monocyte", selected: false},
                    {name: "mononuclear cell", selected: false},
                    {name: "multipotent adult progenitor cell", selected: false},
                    {name: "myometrium", selected: false},
                    {name: "oropharynx", selected: false},
                    {name: "ovary", selected: false},
                    {name: "placenta basal plate", selected: false},
                    {name: "prefrontal cortex", selected: false},
                    {name: "prostate gland", selected: false},
                    {name: "skeletal muscle", selected: false},
                    {name: "skin", selected: false},
                    {name: "small intestine", selected: false},
                    {name: "smooth muscle", selected: false},
                    {name: "T cell", selected: false},
                    {name: "testis", selected: false},
                    {name: "theca", selected: false},
                    {name: "thymocyte", selected: false},
                    {name: "thyrocyte", selected: false},
                    {name: "thyroid gland", selected: false},
                    {name: "tonsil", selected: false},
                    {name: "trabecular meshwork cell", selected: false},
                    {name: "umbilical vein endothelial cell", selected: false}
                ];
            }
        });
    </script>
</polymer-element>