<polymer-element name="jso-network-list-select" attributes="networkViewer textAreaValue">
    <template>
        <link rel="stylesheet" href="../jso-style.css">
        <link rel="stylesheet" href="../jso-form.css">
        <style>
            :host {
                display: block;
                position: relative;
                box-sizing: border-box;
                background-color: #FFFFFF;
                width: 300px;
            }

            .selbox {
                box-sizing: border-box;
                overflow-y: auto;
                border: 1px solid #d3d3d3;
                background-color: #FFF;
            }

            .selitem {
                padding: 2px 5px;
            }

            .selitem[data-checked=true] {
                background-color: #ddd;
            }

            textarea {
                resize: none;
                margin: 3px;
            }
        </style>
        <div horizontal layout>
            <!--<label>Select input list from network:</label>-->
            <label class="control">
                <input type="radio" name="mode" value="nodes" on-change="{{handleRadio}}" checked>
                <span>Network nodes</span>
            </label>
            <label class="control">
                <input type="radio" name="mode" value="selection" on-change="{{handleRadio}}">
                <span>Network selection</span>
            </label>
        </div>
        <label style="margin-top: 5px;">Use attribute:</label>

        <div class="selbox" style="height: 100px;">
            <template repeat="{{column in networkViewer.vAttr.columns}}">
                <div class="selitem"
                     data-checked="{{ columnSelected == column.name }}"
                     on-click="{{handleBoxSelect}}">{{column.title}}
                </div>
            </template>
        </div>
        <div class="button action" on-click="{{handleApply}}" style="margin-top:3px;">Apply</div>
    </template>
    <script>
        Polymer({
            created: function () {
                this.columnSelected = "id";
                this.selectNodes = "nodes";
            },
//            observe: {
//                'networkViewer.vAttr.selected': 'handleSelectionChange',
//                'networkViewer.vAttr.data': 'handleNodesChange'
//            },
            handleRadio: function (e) {
                this.selectNodes = e.target.getAttribute("value");
            },
            handleBoxSelect: function (e) {
                this.columnSelected = e.target.templateInstance.model.column.name;
            },
//            handleNodesChange: function () {
//                if (this.selectNodes == 'nodes') {
//                    this.handleNodesList();
//                }
//            },
//            handleSelectionChange: function () {
//                if (this.selectNodes == 'selection') {
//                    this.handleSelectionList();
//                }
//            },
            handleNodesList: function () {
                this.selectNodes = 'nodes';
                var value = '';
                for (var i = 0; i < this.networkViewer.vAttr.data.length; i++) {
                    var row = this.networkViewer.vAttr.data[i];
                    value += row[this.columnSelected] + '\n';
                }
                this.textAreaValue = value.trim();
            },
            handleSelectionList: function () {
                this.selectNodes = 'selection';
                var value = '';
                for (var i = 0; i < this.networkViewer.vAttr.selected.length; i++) {
                    var row = this.networkViewer.vAttr.selected[i];
                    value += row[this.columnSelected] + '\n';
                }

                this.textAreaValue = value.trim();
            },
            handleApply: function (e) {
                if (this.columnSelected !== "") {
                    if (this.selectNodes == "nodes") {
                        this.handleNodesList();
                    } else if (this.selectNodes == "selection") {
                        this.handleSelectionList();
                    }
                }
            }
        });
    </script>
</polymer-element>